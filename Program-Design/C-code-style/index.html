<!doctype html><html lang=zh class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content=新疆大学飓风战队文档站><link href=https://xju-hurricane-team.github.io/Program-Design/C-code-style/ rel=canonical><link href=../../2024Summer/ rel=prev><link rel=icon href=../../img/logo.png><meta name=generator content="mkdocs-1.6.0, mkdocs-material-9.5.28"><title>C编码风格与规范 - XJU-Hurricane-docs</title><link rel=stylesheet href=../../assets/stylesheets/main.6543a935.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Noto+Sans+SC+-+local:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Noto Sans SC - local";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../stylesheets/extra.23bd66.min.css><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=white data-md-color-accent=blue> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#c class=md-skip> 跳转至 </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=页眉> <a href=../.. title=XJU-Hurricane-docs class="md-header__button md-logo" aria-label=XJU-Hurricane-docs data-md-component=logo> <img src=../../img/logo-banner.png alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> XJU-Hurricane-docs </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> C编码风格与规范 </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=white data-md-color-accent=blue aria-label=切换暗色模式 type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title=切换暗色模式 for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0 8a5 5 0 0 1-5-5 5 5 0 0 1 5-5 5 5 0 0 1 5 5 5 5 0 0 1-5 5m0-12.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5Z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=black data-md-color-accent=blue aria-label=切换亮色模式 type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title=切换亮色模式 for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 9a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3m0-4.5c5 0 9.27 3.11 11 7.5-1.73 4.39-6 7.5-11 7.5S2.73 16.39 1 12c1.73-4.39 6-7.5 11-7.5M3.18 12a9.821 9.821 0 0 0 17.64 0 9.821 9.821 0 0 0-17.64 0Z"/></svg> </label> </form> <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=搜索 placeholder=搜索 autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=查找> <button type=reset class="md-search__icon md-icon" title=清空当前内容 aria-label=清空当前内容 tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> 正在初始化搜索引擎 </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/XJU-Hurricane-Team/xju-hurricane-team.github.io title=前往仓库 class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33.85 0 1.71.11 2.5.33 1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2Z"/></svg> </div> <div class=md-source__repository> GitHub </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=标签 data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../.. class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=../../2024Summer/ class=md-tabs__link> 2024暑期学习 </a> </li> <li class=md-tabs__item> <a href=https://deadline039.github.io/Cpp/ class=md-tabs__link> C语言基础 </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=./ class=md-tabs__link> C编码风格与规范 </a> </li> <li class=md-tabs__item> <a href=https://deadline039.github.io/Embedded/ class=md-tabs__link> 嵌入式技术 </a> </li> <li class=md-tabs__item> <a href=https://deadline039.github.io/Linux/ class=md-tabs__link> Linux </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=导航栏 data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title=XJU-Hurricane-docs class="md-nav__button md-logo" aria-label=XJU-Hurricane-docs data-md-component=logo> <img src=../../img/logo-banner.png alt=logo> </a> XJU-Hurricane-docs </label> <div class=md-nav__source> <a href=https://github.com/XJU-Hurricane-Team/xju-hurricane-team.github.io title=前往仓库 class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33.85 0 1.71.11 2.5.33 1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2Z"/></svg> </div> <div class=md-source__repository> GitHub </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> <span class=md-ellipsis> Home </span> </a> </li> <li class=md-nav__item> <a href=../../2024Summer/ class=md-nav__link> <span class=md-ellipsis> 2024暑期学习 </span> </a> </li> <li class=md-nav__item> <a href=https://deadline039.github.io/Cpp/ class=md-nav__link> <span class=md-ellipsis> C语言基础 </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> C编码风格与规范 </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> C编码风格与规范 </span> </a> <nav class="md-nav md-nav--secondary" aria-label=目录> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> 目录 </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#_1 class=md-nav__link> <span class=md-ellipsis> 省流 </span> </a> </li> <li class=md-nav__item> <a href=#_2 class=md-nav__link> <span class=md-ellipsis> 为什么需要规范代码风格和命名 </span> </a> </li> <li class=md-nav__item> <a href=#_3 class=md-nav__link> <span class=md-ellipsis> 命名禁忌 </span> </a> </li> <li class=md-nav__item> <a href=#_4 class=md-nav__link> <span class=md-ellipsis> 命名规则 </span> </a> <nav class=md-nav aria-label=命名规则> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_5 class=md-nav__link> <span class=md-ellipsis> 包含单位 </span> </a> </li> <li class=md-nav__item> <a href=#_6 class=md-nav__link> <span class=md-ellipsis> 函数 </span> </a> </li> <li class=md-nav__item> <a href=#_7 class=md-nav__link> <span class=md-ellipsis> 变量 </span> </a> </li> <li class=md-nav__item> <a href=#_8 class=md-nav__link> <span class=md-ellipsis> 宏定义 </span> </a> </li> <li class=md-nav__item> <a href=#_9 class=md-nav__link> <span class=md-ellipsis> 句柄 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#_10 class=md-nav__link> <span class=md-ellipsis> 代码规范 </span> </a> <nav class=md-nav aria-label=代码规范> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_11 class=md-nav__link> <span class=md-ellipsis> 头文件 </span> </a> </li> <li class=md-nav__item> <a href=#_12 class=md-nav__link> <span class=md-ellipsis> 源文件 </span> </a> </li> <li class=md-nav__item> <a href=#_13 class=md-nav__link> <span class=md-ellipsis> 缩进与空格 </span> </a> </li> <li class=md-nav__item> <a href=#_14 class=md-nav__link> <span class=md-ellipsis> 括号换行 </span> </a> </li> <li class=md-nav__item> <a href=#_15 class=md-nav__link> <span class=md-ellipsis> 空行 </span> </a> </li> <li class=md-nav__item> <a href=#_16 class=md-nav__link> <span class=md-ellipsis> 代码行 </span> </a> </li> <li class=md-nav__item> <a href=#_17 class=md-nav__link> <span class=md-ellipsis> 代码块 </span> </a> </li> <li class=md-nav__item> <a href=#_18 class=md-nav__link> <span class=md-ellipsis> 函数 </span> </a> </li> <li class=md-nav__item> <a href=#_19 class=md-nav__link> <span class=md-ellipsis> 变量 </span> </a> </li> <li class=md-nav__item> <a href=#_20 class=md-nav__link> <span class=md-ellipsis> 复杂数据类型 </span> </a> </li> <li class=md-nav__item> <a href=#_21 class=md-nav__link> <span class=md-ellipsis> 数组与指针 </span> </a> </li> <li class=md-nav__item> <a href=#_22 class=md-nav__link> <span class=md-ellipsis> 宏定义 </span> </a> </li> <li class=md-nav__item> <a href=#goto class=md-nav__link> <span class=md-ellipsis> goto </span> </a> </li> <li class=md-nav__item> <a href=#_23 class=md-nav__link> <span class=md-ellipsis> 杂项 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#_24 class=md-nav__link> <span class=md-ellipsis> 注释 </span> </a> <nav class=md-nav aria-label=注释> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_25 class=md-nav__link> <span class=md-ellipsis> 文件头 </span> </a> </li> <li class=md-nav__item> <a href=#_26 class=md-nav__link> <span class=md-ellipsis> 函数 </span> </a> </li> <li class=md-nav__item> <a href=#_27 class=md-nav__link> <span class=md-ellipsis> 结构体 </span> </a> </li> <li class=md-nav__item> <a href=#_28 class=md-nav__link> <span class=md-ellipsis> 模块 </span> </a> </li> <li class=md-nav__item> <a href=#_29 class=md-nav__link> <span class=md-ellipsis> 预编译命令 </span> </a> </li> <li class=md-nav__item> <a href=#_30 class=md-nav__link> <span class=md-ellipsis> 杂项 </span> </a> </li> <li class=md-nav__item> <a href=#_31 class=md-nav__link> <span class=md-ellipsis> 自动生成注释 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#_32 class=md-nav__link> <span class=md-ellipsis> 文件编码 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=https://deadline039.github.io/Embedded/ class=md-nav__link> <span class=md-ellipsis> 嵌入式技术 </span> </a> </li> <li class=md-nav__item> <a href=https://deadline039.github.io/Linux/ class=md-nav__link> <span class=md-ellipsis> Linux </span> </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label=目录> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> 目录 </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#_1 class=md-nav__link> <span class=md-ellipsis> 省流 </span> </a> </li> <li class=md-nav__item> <a href=#_2 class=md-nav__link> <span class=md-ellipsis> 为什么需要规范代码风格和命名 </span> </a> </li> <li class=md-nav__item> <a href=#_3 class=md-nav__link> <span class=md-ellipsis> 命名禁忌 </span> </a> </li> <li class=md-nav__item> <a href=#_4 class=md-nav__link> <span class=md-ellipsis> 命名规则 </span> </a> <nav class=md-nav aria-label=命名规则> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_5 class=md-nav__link> <span class=md-ellipsis> 包含单位 </span> </a> </li> <li class=md-nav__item> <a href=#_6 class=md-nav__link> <span class=md-ellipsis> 函数 </span> </a> </li> <li class=md-nav__item> <a href=#_7 class=md-nav__link> <span class=md-ellipsis> 变量 </span> </a> </li> <li class=md-nav__item> <a href=#_8 class=md-nav__link> <span class=md-ellipsis> 宏定义 </span> </a> </li> <li class=md-nav__item> <a href=#_9 class=md-nav__link> <span class=md-ellipsis> 句柄 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#_10 class=md-nav__link> <span class=md-ellipsis> 代码规范 </span> </a> <nav class=md-nav aria-label=代码规范> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_11 class=md-nav__link> <span class=md-ellipsis> 头文件 </span> </a> </li> <li class=md-nav__item> <a href=#_12 class=md-nav__link> <span class=md-ellipsis> 源文件 </span> </a> </li> <li class=md-nav__item> <a href=#_13 class=md-nav__link> <span class=md-ellipsis> 缩进与空格 </span> </a> </li> <li class=md-nav__item> <a href=#_14 class=md-nav__link> <span class=md-ellipsis> 括号换行 </span> </a> </li> <li class=md-nav__item> <a href=#_15 class=md-nav__link> <span class=md-ellipsis> 空行 </span> </a> </li> <li class=md-nav__item> <a href=#_16 class=md-nav__link> <span class=md-ellipsis> 代码行 </span> </a> </li> <li class=md-nav__item> <a href=#_17 class=md-nav__link> <span class=md-ellipsis> 代码块 </span> </a> </li> <li class=md-nav__item> <a href=#_18 class=md-nav__link> <span class=md-ellipsis> 函数 </span> </a> </li> <li class=md-nav__item> <a href=#_19 class=md-nav__link> <span class=md-ellipsis> 变量 </span> </a> </li> <li class=md-nav__item> <a href=#_20 class=md-nav__link> <span class=md-ellipsis> 复杂数据类型 </span> </a> </li> <li class=md-nav__item> <a href=#_21 class=md-nav__link> <span class=md-ellipsis> 数组与指针 </span> </a> </li> <li class=md-nav__item> <a href=#_22 class=md-nav__link> <span class=md-ellipsis> 宏定义 </span> </a> </li> <li class=md-nav__item> <a href=#goto class=md-nav__link> <span class=md-ellipsis> goto </span> </a> </li> <li class=md-nav__item> <a href=#_23 class=md-nav__link> <span class=md-ellipsis> 杂项 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#_24 class=md-nav__link> <span class=md-ellipsis> 注释 </span> </a> <nav class=md-nav aria-label=注释> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_25 class=md-nav__link> <span class=md-ellipsis> 文件头 </span> </a> </li> <li class=md-nav__item> <a href=#_26 class=md-nav__link> <span class=md-ellipsis> 函数 </span> </a> </li> <li class=md-nav__item> <a href=#_27 class=md-nav__link> <span class=md-ellipsis> 结构体 </span> </a> </li> <li class=md-nav__item> <a href=#_28 class=md-nav__link> <span class=md-ellipsis> 模块 </span> </a> </li> <li class=md-nav__item> <a href=#_29 class=md-nav__link> <span class=md-ellipsis> 预编译命令 </span> </a> </li> <li class=md-nav__item> <a href=#_30 class=md-nav__link> <span class=md-ellipsis> 杂项 </span> </a> </li> <li class=md-nav__item> <a href=#_31 class=md-nav__link> <span class=md-ellipsis> 自动生成注释 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#_32 class=md-nav__link> <span class=md-ellipsis> 文件编码 </span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <a href=https://github.com/XJU-Hurricane-Team/xju-hurricane-team.github.io/edit/main/docs/zh/Program-Design/C-code-style.md title=编辑此页 class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4v-2m10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1 2.1 2.1Z"/></svg> </a> <h1 id=c>C编码风格与规范</h1> <blockquote> <p>If you need more than 3 levels of indentation, you’re screwed anyway, and should fix your program.</p> <p>如果你的代码缩进超过三层，意味着你已经搞砸了，你需要重构。</p> <p>——Linux之父Linus Torvalds</p> </blockquote> <p>你的代码是给别人看的，不是光你自己看的。因此代码可读性是第一位。</p> <p>下面有些代码技巧只是建议，实际代码怎么写还要靠你自己去斟酌，比如我说我们大部分声明的变量值都不会变，那么可以适当考虑添加<code>const</code>修饰符，不要见到个变量就加。</p> <p>总之，我不希望把写代码当成中学的作业一样，完成功能就完事，顶多老师讲题的时候review一下。代码怎么写，怎么处理现实世界复杂的逻辑，企业是如何构建和管理一个复杂的大型项目的，没有老师或者课程能教会你，也没有标准答案。</p> <p><strong><em>Try to regard code as art. Code contains huge power to change the world. Just enjoy it!</em></strong> </p> <h2 id=_1>省流</h2> <ul> <li>代码规范对于提高代码质量非常重要</li> </ul> <ul> <li>命名用下划线命名法，宏定义字母全大写，预编译命令的<code>#else, #endif</code>行末加注释说明条件</li> </ul> <ul> <li>全局变量加<code>g_</code>前缀，全局指针加<code>p_</code>前缀。如果不公开使用加<code>static</code>修饰符，可以不加前缀</li> </ul> <ul> <li>命名务必简明扼要，不要意义不明</li> </ul> <ul> <li>结构体/联合体/枚举等复杂数据类型，除非不公开，统一用<code>typedef</code>定义名称，并加上<code>_t</code>后缀</li> </ul> <ul> <li>缩进最多接受6层，超过6层必须重写；预编译如果嵌套命令不缩进</li> </ul> <ul> <li>嵌入式程序中不准使用递归</li> </ul> <ul> <li>对于有返回值的函数，必须返回一个默认值，不能有什么都不返回的情况</li> </ul> <ul> <li>不准使用未定义的变量，使用变量前必须定义初值</li> </ul> <ul> <li>代码排版按照我写的<code>.clang-format</code>格式化</li> </ul> <ul> <li>注释用<code>doxygen</code></li> </ul> <h2 id=_2>为什么需要规范代码风格和命名</h2> <p>对于一个高质量的工程，一般会做到：</p> <ol> <li> <p>代码简洁精炼，美观，可读性好，高效率，高复用，可移植性好，高内聚，低耦合，没有冗余，不符合这些原则，必须特别说明。</p> </li> <li> <p>规范性，代码有规可循。特殊排版、特殊语法、特殊指令，必须特别说明。</p> </li> </ol> <p>我们规范代码风格和命名的愿景是码出高效，码出质量。现代软件架构的复杂性需要协同开发完成，如何高效地协同呢？无规矩不成方圆，无规范难以协同，比如，制定交通法规表面上是要限制行车权，实际上是保障公众的人身安全，试想如果没有限速，没有红绿灯，谁还敢上路行驶？对软件来说，适当的规范和标准绝不是消灭代码内容的创造性、优雅性，而是限制过度个性化，以一种普遍认可的统一方式一起做事，提升协作效率，降低沟通成本。代码的字里行间流淌的是软件系统的血液，代码质量的提升是尽可能少踩坑，杜绝踩重复的坑，切实提升系统稳定性，码出质量。</p> <p>规范代码风格可以方便代码移植和复用，提高代码可读性，而好的命名是对程序非常重要的，命名是编程的心脏，如果连命名都做不好，那么程序过不了多久就会变得难以维护。你的代码是写给别人看的，如果你自己都看不懂的代码别人更看不懂。所以代码和命名规范，非常重要。</p> <p>参照：<a href=https://users.ece.cmu.edu/~eno/coding/CCodingStandard.html#names>C Coding Standard (cmu.edu)</a></p> <h2 id=_3>命名禁忌</h2> <p>下面的命名绝对不允许出现，如果在企业项目中敢这样命名，你的上司和同事绝对会拿键盘来砸你。</p> <p>参照视频：<a href=https://www.bilibili.com/video/av275983985/ >代码命名怎么可能让别人满意？自己满意就行了 Naming Things in Code 变量命名_哔哩哔哩 (゜-゜)つロ 干杯~-bilibili</a></p> <ul> <li>单字母：<code>int a, b, c; float x, y, z</code>，循环变量可以使用<code>i,j,k</code>，但<strong>不要把<code>i,j,k</code>定义成全局变量</strong></li> </ul> <ul> <li>重复的无意义字母：<code>int aa, bb, cc, dd</code></li> </ul> <ul> <li>拼音及拼音首字母缩写：<code>char[30] mingZi, sb, nb; char xingbie; int xh, nl</code>，对于一些公认的拼音，可以使用，如<code>Alibaba, Aliyun, Baidu, Bilibili, Sogou</code>等（貌似都是公司名）</li> </ul> <ul> <li>不规范的缩写：<code>int cont_freq</code>，查询常见单词的缩写可以使用这个网站：<a href=https://www.abbreviations.com/ >Abbreviations.com</a></li> </ul> <h2 id=_4>命名规则</h2> <p>命名的总原则是精准地描述功能。如果命名意义不明确，那么代码也是没有意义的。命名要做到见名知意，而不是让别人去猜。好的命名是自解释的，也就是从名字就可以看出来含义，不需要注释去说明。在程序开发中，<strong>如果一段代码或者变量没有意义，那么这段代码或者变量就不应该存在。</strong></p> <p><strong>统一使用下划线命名法，即单词全部使用小写字母，包括函数、变量、结构体等。单词之间用下划线隔开。对于第三方代码保留其命名风格，不要修改。</strong></p> <ul> <li>统一性：编写一个模块的代码时，最好使用一个统一的前缀，比如操作NAND Flash的代码，可以加一个<code>nand_</code>前缀</li> </ul> <ul> <li>与作用域关联：变量命名的长度和他的作用域有关，作用域越大，命名尽可能越长。这样能最大程度避免命名冲突</li> </ul> <ul> <li>最短长度，最大化信息：在保持一个标识符意思明确的同时，尽量缩短长度。尽量不要超过6个单词</li> </ul> <ul> <li>避免重名或相似：避免在不同级别作用域中重名，虽然在C/C++中允许局部变量和全局变量重名，但这样容易引起误解</li> </ul> <ul> <li>避免出现编号：如<code>number1, number2</code>，可以使用数组代替。除非在逻辑上必须使用编号，无法用数组代替，比如<code>USART1, USART2</code></li> </ul> <h3 id=_5>包含单位</h3> <p>这种命名适合用在参数中，比如要传入等待超时时间，单位是毫秒，那么就可以写<code>timeout_ms</code>；让电机转到一个角度，单位是度，可以用<code>target_angle_degree</code>。当然如果太长，也可以在注释的<code>@param</code>注明。</p> <h3 id=_6>函数</h3> <p>函数命名要和功能或者行为准确对应。一般是动词+名词，如果命名不算长，介词也是必要的，比如<code>dump_data_to_file</code>，这样阅读起来非常自然，也好分辨，当然一个变量不要搞太多的单词，尽量不超过6个。</p> <p>如果一个函数是进行某个动作，如<code>get, set</code>，那么一般把动词放前面。比如获取当前队列的消息，最好用<code>get_queue_msg</code>，而不是<code>queue_msg_get</code>。如果某个东西是进行判断的，最好加<code>is</code>前缀，比如判断消息队列是否已满的函数，最好写<code>is_msg_queue_full</code>，而不是<code>msg_queue_full</code>。</p> <p>有时候使用互斥词是一个较好的命名方式，常见的互斥词如下：</p> <div class=highlight><pre><span></span><code><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a>add/remove      begin/end           create/destroy      insert/delete 
<a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a>first/last      get/release         increment/decrement put/get/add/delete
<a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a>lock/unlock     open/close          min/max             old/new 
<a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a>start/stop      next/previous       source/target       show/hide 
<a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a>send/receive    source/destination  copy/paste          up/down
</code></pre></div> <h3 id=_7>变量</h3> <p>变量命名尽量用形容词+名词，可以把变量想象成一个容器，比如<code>red_envelop_money</code></p> <p>可以加修饰词，一般把修饰词放后面，这些修饰词包括<code>max, min, count</code>等。比如消息队列能容纳的最大值，最好用<code>msg_queue_max</code>，而不是<code>max_msg_queue</code>。</p> <p>对于局部变量，命名不要太长，1~3个单词为宜。不要违反上面所说的禁忌。</p> <p>全局变量加<code>g_</code>前缀，全局指针加<code>p_</code>前缀，句柄可以不用加前缀。全局变量除前缀外最好2~5个单词，这样能最大程度避免重名。不要违反上面所说的禁忌。</p> <p><code>i,j,k</code>可以作为循环变量，但只能在循环内使用，不能让循环变量的作用域超出循环体：</p> <div class=highlight><pre><span></span><code><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a><span class=cm>/* 不允许, 正点原子采用这种方式是为了兼容C89 */</span>
<a id=__codelineno-1-2 name=__codelineno-1-2 href=#__codelineno-1-2></a><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=p>;</span>
<a id=__codelineno-1-3 name=__codelineno-1-3 href=#__codelineno-1-3></a><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>count</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=o>++</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-1-4 name=__codelineno-1-4 href=#__codelineno-1-4></a><span class=w>    </span><span class=n>list</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>...</span>
<a id=__codelineno-1-5 name=__codelineno-1-5 href=#__codelineno-1-5></a><span class=p>}</span>
<a id=__codelineno-1-6 name=__codelineno-1-6 href=#__codelineno-1-6></a><span class=cm>/* 使用下面的方式让循环变量的作用域只在for循环里 */</span>
<a id=__codelineno-1-7 name=__codelineno-1-7 href=#__codelineno-1-7></a><span class=cm>/* PS: C标准至少在C99以上, C89这样写会报错 */</span>
<a id=__codelineno-1-8 name=__codelineno-1-8 href=#__codelineno-1-8></a><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>count</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=o>++</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-1-9 name=__codelineno-1-9 href=#__codelineno-1-9></a><span class=w>    </span><span class=n>list</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>...</span>
<a id=__codelineno-1-10 name=__codelineno-1-10 href=#__codelineno-1-10></a><span class=p>}</span>
</code></pre></div> <p>如果要在循环外使用循环变量，比如要查找一个值的位置，<strong>那说明这个循环变量是有意义的</strong>，不能用<code>i,j,k</code>这种单纯下标意义的变量来命名。</p> <h3 id=_8>宏定义</h3> <p>宏定义常量时<strong>字母全部用大写</strong>，同时宏定义尽量加前缀。</p> <p>对于头文件中避免重复编译的宏<code>#ifndef __XXX_H #define __XXX_H</code>，标识符使用<code>__XXX_H</code>的写法，即两个下划线开头，XXX一般是文件名的大写字母，随后跟上一个下划线加一个H。</p> <h3 id=_9>句柄</h3> <p>句柄加<code>_handle</code>后缀，句柄名称与类型和功能匹配就可以了</p> <h2 id=_10>代码规范</h2> <p>保持代码风格的统一，对code reading, review, refactoring, porting等都有好处。这些代码规范大多数情况下Clang-format都会帮我们自动排版，无需我们手动调整。<strong>统一使用Github中<code>STM32_Template</code>的<code>.clang-format</code>文件。</strong></p> <h3 id=_11>头文件</h3> <ul> <li>只引用需要的头文件，不要包含一堆头文件</li> </ul> <ul> <li><code>#include</code>中的文件名对大小写敏感</li> </ul> <ul> <li>头文件放在<code>Inc</code>目录，源文件放在<code>Src</code>目录</li> </ul> <ul> <li>对于C++代码，头文件使用<code>.hpp</code>后缀</li> </ul> <ul> <li>如果一个目录中有多个子目录中的头文件需要包含，使用相对路径，不要在<code>IncludePath</code>中添加，例如：</li> </ul> <div class=highlight><pre><span></span><code><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a><span class=cm>/*</span>
<a id=__codelineno-2-2 name=__codelineno-2-2 href=#__codelineno-2-2></a><span class=cm>某个模块的文件结构：</span>
<a id=__codelineno-2-3 name=__codelineno-2-3 href=#__codelineno-2-3></a><span class=cm>model_root</span>
<a id=__codelineno-2-4 name=__codelineno-2-4 href=#__codelineno-2-4></a><span class=cm>├─foldA</span>
<a id=__codelineno-2-5 name=__codelineno-2-5 href=#__codelineno-2-5></a><span class=cm>│  └─functionA.h</span>
<a id=__codelineno-2-6 name=__codelineno-2-6 href=#__codelineno-2-6></a><span class=cm>├─foldB</span>
<a id=__codelineno-2-7 name=__codelineno-2-7 href=#__codelineno-2-7></a><span class=cm>│  └─functionB.h</span>
<a id=__codelineno-2-8 name=__codelineno-2-8 href=#__codelineno-2-8></a><span class=cm>├─foldC</span>
<a id=__codelineno-2-9 name=__codelineno-2-9 href=#__codelineno-2-9></a><span class=cm>│  └─functionC.h</span>
<a id=__codelineno-2-10 name=__codelineno-2-10 href=#__codelineno-2-10></a><span class=cm>├─foldnD</span>
<a id=__codelineno-2-11 name=__codelineno-2-11 href=#__codelineno-2-11></a><span class=cm>│  └─functionD.h</span>
<a id=__codelineno-2-12 name=__codelineno-2-12 href=#__codelineno-2-12></a><span class=cm>├─foldE</span>
<a id=__codelineno-2-13 name=__codelineno-2-13 href=#__codelineno-2-13></a><span class=cm>│  └─functionE.h</span>
<a id=__codelineno-2-14 name=__codelineno-2-14 href=#__codelineno-2-14></a><span class=cm>└─foldF</span>
<a id=__codelineno-2-15 name=__codelineno-2-15 href=#__codelineno-2-15></a><span class=cm>   └─functionF.h</span>
<a id=__codelineno-2-16 name=__codelineno-2-16 href=#__codelineno-2-16></a><span class=cm>假如都需要这6个模块的头文件, IncludePath中只添加了model_root. </span>
<a id=__codelineno-2-17 name=__codelineno-2-17 href=#__codelineno-2-17></a><span class=cm>*/</span>
<a id=__codelineno-2-18 name=__codelineno-2-18 href=#__codelineno-2-18></a>
<a id=__codelineno-2-19 name=__codelineno-2-19 href=#__codelineno-2-19></a><span class=cm>/* 你当然可以大力出奇迹, 将这6个文件夹全部添加到IncludePath中, 然后 */</span>
<a id=__codelineno-2-20 name=__codelineno-2-20 href=#__codelineno-2-20></a><span class=cp>#include</span><span class=w> </span><span class=cpf>&quot;functionA.h&quot;</span>
<a id=__codelineno-2-21 name=__codelineno-2-21 href=#__codelineno-2-21></a><span class=cp>#include</span><span class=w> </span><span class=cpf>&quot;functionB.h&quot;</span>
<a id=__codelineno-2-22 name=__codelineno-2-22 href=#__codelineno-2-22></a><span class=p>...</span>
<a id=__codelineno-2-23 name=__codelineno-2-23 href=#__codelineno-2-23></a><span class=cp>#include</span><span class=w> </span><span class=cpf>&quot;functionF.h&quot;</span>
<a id=__codelineno-2-24 name=__codelineno-2-24 href=#__codelineno-2-24></a>
<a id=__codelineno-2-25 name=__codelineno-2-25 href=#__codelineno-2-25></a><span class=cm>/* 但更好的做法是, 不添加IncludePath, 使用相对路径包含, 保证根目录在IncludePath就可以 */</span>
<a id=__codelineno-2-26 name=__codelineno-2-26 href=#__codelineno-2-26></a><span class=cp>#include</span><span class=w> </span><span class=cpf>&quot;./flodA/functionA.h&quot;</span>
<a id=__codelineno-2-27 name=__codelineno-2-27 href=#__codelineno-2-27></a><span class=cp>#include</span><span class=w> </span><span class=cpf>&quot;./foldB/functionB.h&quot;</span>
<a id=__codelineno-2-28 name=__codelineno-2-28 href=#__codelineno-2-28></a><span class=p>...</span>
<a id=__codelineno-2-29 name=__codelineno-2-29 href=#__codelineno-2-29></a><span class=cp>#include</span><span class=w> </span><span class=cpf>&quot;./foldF/functionf.h&quot;</span>
</code></pre></div> <h3 id=_12>源文件</h3> <ul> <li>不要使用无意义的名称，如果是某个模块的代码，保证服务对象单一，不要包含太多其他模块的代码。</li> </ul> <ul> <li>对于C++代码，使用<code>.cpp</code>后缀</li> </ul> <ul> <li>头文件开头和末尾必须加上固定格式的宏定义，即<code>#ifndef ... #endif</code></li> </ul> <div class=highlight><pre><span></span><code><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a><span class=cm>/**</span>
<a id=__codelineno-3-2 name=__codelineno-3-2 href=#__codelineno-3-2></a><span class=cm> * @file    xxx.h</span>
<a id=__codelineno-3-3 name=__codelineno-3-3 href=#__codelineno-3-3></a><span class=cm> * @brief   balabala</span>
<a id=__codelineno-3-4 name=__codelineno-3-4 href=#__codelineno-3-4></a><span class=cm> * @auhor   yourname</span>
<a id=__codelineno-3-5 name=__codelineno-3-5 href=#__codelineno-3-5></a><span class=cm> * @date    2024-02-20</span>
<a id=__codelineno-3-6 name=__codelineno-3-6 href=#__codelineno-3-6></a><span class=cm> * @version 0.1</span>
<a id=__codelineno-3-7 name=__codelineno-3-7 href=#__codelineno-3-7></a><span class=cm> */</span>
<a id=__codelineno-3-8 name=__codelineno-3-8 href=#__codelineno-3-8></a>
<a id=__codelineno-3-9 name=__codelineno-3-9 href=#__codelineno-3-9></a><span class=cp>#ifndef __XXX_H</span>
<a id=__codelineno-3-10 name=__codelineno-3-10 href=#__codelineno-3-10></a><span class=cp>#define __XXX_H</span>
<a id=__codelineno-3-11 name=__codelineno-3-11 href=#__codelineno-3-11></a>
<a id=__codelineno-3-12 name=__codelineno-3-12 href=#__codelineno-3-12></a><span class=p>...</span>
<a id=__codelineno-3-13 name=__codelineno-3-13 href=#__codelineno-3-13></a>
<a id=__codelineno-3-14 name=__codelineno-3-14 href=#__codelineno-3-14></a><span class=cp>#endif  </span><span class=cm>/* __XXX_H */</span>
</code></pre></div> <h3 id=_13>缩进与空格</h3> <ul> <li>统一使用4个空格缩进，不使用Tab缩进，不同编辑器定义的制表符长度不一，容易产生错位，所以使用<strong>四个空格代替制表符</strong></li> </ul> <ul> <li>嵌套缩进尽量控制在4层以内，最多接受6层，<strong>超过4层优化，超过6层必须重写</strong></li> </ul> <ul> <li><code>if () {}, switch () {}, case () {}</code>这类带花括号的关键字后须有空格；但是对于不跟花括号的关键字，如<code>sizeof(), __attribute__()</code>，以及函数调用，不带空格</li> </ul> <ul> <li>圆括号、方括号内的代码与括号之间不加空格，外边根据情况添加空格，比如下面第2行的代码不应该写成：<code>data [ 3 ] = ( uint8_t )( verify_key &gt;&gt; 8 );</code></li> </ul> <ul> <li>二元、三元操作符前后都要加空格，如：<code>= + - &lt; &gt; * / % ^ &lt;= &gt;= == != ? :</code></li> </ul> <ul> <li>一元操作符后不要加空格，如：<code>&amp;(取地址) *(取指针的内容) + - ~ !</code>，但是如果声明指针变量，<code>*</code>放在靠近变量名的一侧，星号左边有一个空格</li> </ul> <ul> <li>自增和自减运算符前后都不加空格，如：<code>num++, --num</code></li> </ul> <ul> <li>访问结构体成员的操作符前后不加空格，如：<code>Init.Mode, hspi-&gt;Instance</code></li> </ul> <ul> <li>逗号，分号只在后面添加空格，如：<code>int age_max, age_min;</code>如果分号在行末，空格可加可不加</li> </ul> <ul> <li>数组下标的方括号都没有空格，如<code>buf[i]</code></li> </ul> <ul> <li>块注释<code>/* xxx */</code>与注释内容xxx前后各一个空格</li> </ul> <ul> <li>行注释<code>// xxx</code>双斜线后有一个空格，且两条斜线与行对齐，不要放在行首</li> </ul> <p>以上几点代码举例：</p> <div class=highlight><pre><span></span><code><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a><span class=cm>/* 运算符与数组下标 */</span>
<a id=__codelineno-4-2 name=__codelineno-4-2 href=#__codelineno-4-2></a><span class=n>data</span><span class=p>[</span><span class=mi>3</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=kt>uint8_t</span><span class=p>)(</span><span class=n>verify_key</span><span class=w> </span><span class=o>&gt;&gt;</span><span class=w> </span><span class=mi>8</span><span class=p>);</span>
<a id=__codelineno-4-3 name=__codelineno-4-3 href=#__codelineno-4-3></a><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=n>num</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=o>++</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-4-4 name=__codelineno-4-4 href=#__codelineno-4-4></a><span class=w>    </span><span class=n>datax</span><span class=o>-&gt;</span><span class=n>buf</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>x1</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=p>(</span><span class=n>x2</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>i</span><span class=p>)</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>baseval</span><span class=p>;</span>
<a id=__codelineno-4-5 name=__codelineno-4-5 href=#__codelineno-4-5></a><span class=p>}</span>
<a id=__codelineno-4-6 name=__codelineno-4-6 href=#__codelineno-4-6></a>
<a id=__codelineno-4-7 name=__codelineno-4-7 href=#__codelineno-4-7></a><span class=cm>/* 声明指针变量 */</span>
<a id=__codelineno-4-8 name=__codelineno-4-8 href=#__codelineno-4-8></a><span class=kt>char</span><span class=w> </span><span class=o>*</span><span class=n>str</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nb>NULL</span><span class=p>;</span>
</code></pre></div> <p>当然了，我们没必要关注这么多细节，大多数情况下自动格式化都会做好这一切。</p> <h3 id=_14>括号换行</h3> <ul> <li>所有左花括号不换行，右花括号单独一行，对于<code>else</code>语句右花括号不换行。这样是为了减少代码阅读负担，一个左花括号占一行代码会看起来比较长，右花括号单独一行可以提醒读者这个代码块到底了</li> </ul> <ul> <li>对于参数列表或者其他圆括号内换行场景，后行与第一行左括号后第一个字符对齐，右括号不另起一行</li> </ul> <div class=highlight><pre><span></span><code><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a><span class=cm>/* 花括号使用案例 */</span>
<a id=__codelineno-5-2 name=__codelineno-5-2 href=#__codelineno-5-2></a><span class=cm>/**</span>
<a id=__codelineno-5-3 name=__codelineno-5-3 href=#__codelineno-5-3></a><span class=cm> * @brief 按键扫描</span>
<a id=__codelineno-5-4 name=__codelineno-5-4 href=#__codelineno-5-4></a><span class=cm> *</span>
<a id=__codelineno-5-5 name=__codelineno-5-5 href=#__codelineno-5-5></a><span class=cm> * @param mode 是否支持连按</span>
<a id=__codelineno-5-6 name=__codelineno-5-6 href=#__codelineno-5-6></a><span class=cm> *  0-不支持连按, 1-支持连按</span>
<a id=__codelineno-5-7 name=__codelineno-5-7 href=#__codelineno-5-7></a><span class=cm> * @return 按下的按键</span>
<a id=__codelineno-5-8 name=__codelineno-5-8 href=#__codelineno-5-8></a><span class=cm> *  @retval 按下:`KEY0_PRES ~ WKUP_PRES`</span>
<a id=__codelineno-5-9 name=__codelineno-5-9 href=#__codelineno-5-9></a><span class=cm> *  @retval 未按下:`0`</span>
<a id=__codelineno-5-10 name=__codelineno-5-10 href=#__codelineno-5-10></a><span class=cm> * @note 注意此函数有响应优先级,`KEY0 &gt; KEY1 &gt; WK_UP`</span>
<a id=__codelineno-5-11 name=__codelineno-5-11 href=#__codelineno-5-11></a><span class=cm> */</span>
<a id=__codelineno-5-12 name=__codelineno-5-12 href=#__codelineno-5-12></a><span class=kt>uint8_t</span><span class=w> </span><span class=nf>key_scan</span><span class=p>(</span><span class=kt>uint8_t</span><span class=w> </span><span class=n>mode</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-5-13 name=__codelineno-5-13 href=#__codelineno-5-13></a><span class=w>    </span><span class=k>static</span><span class=w> </span><span class=kt>uint8_t</span><span class=w> </span><span class=n>key_up</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=p>;</span><span class=w> </span><span class=cm>/* 按键松开标志 */</span>
<a id=__codelineno-5-14 name=__codelineno-5-14 href=#__codelineno-5-14></a><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>mode</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-5-15 name=__codelineno-5-15 href=#__codelineno-5-15></a><span class=w>        </span><span class=n>key_up</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=p>;</span><span class=w> </span><span class=cm>/* 支持连按 */</span>
<a id=__codelineno-5-16 name=__codelineno-5-16 href=#__codelineno-5-16></a><span class=w>    </span><span class=p>}</span>
<a id=__codelineno-5-17 name=__codelineno-5-17 href=#__codelineno-5-17></a><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>key_up</span><span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=p>(</span><span class=n>KEY0</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=o>||</span><span class=w> </span><span class=n>KEY1</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=o>||</span><span class=w> </span><span class=n>WK_UP</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=mi>1</span><span class=p>))</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-5-18 name=__codelineno-5-18 href=#__codelineno-5-18></a><span class=w>        </span><span class=n>delay_ms</span><span class=p>(</span><span class=mi>10</span><span class=p>);</span>
<a id=__codelineno-5-19 name=__codelineno-5-19 href=#__codelineno-5-19></a><span class=w>        </span><span class=n>key_up</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
<a id=__codelineno-5-20 name=__codelineno-5-20 href=#__codelineno-5-20></a><span class=w>        </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>KEY0</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=mi>0</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-5-21 name=__codelineno-5-21 href=#__codelineno-5-21></a><span class=w>            </span><span class=k>return</span><span class=w> </span><span class=n>KEY0_PRES</span><span class=p>;</span>
<a id=__codelineno-5-22 name=__codelineno-5-22 href=#__codelineno-5-22></a><span class=w>        </span><span class=p>}</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>KEY1</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=mi>0</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-5-23 name=__codelineno-5-23 href=#__codelineno-5-23></a><span class=w>            </span><span class=k>return</span><span class=w> </span><span class=n>KEY1_PRES</span><span class=p>;</span>
<a id=__codelineno-5-24 name=__codelineno-5-24 href=#__codelineno-5-24></a><span class=w>        </span><span class=p>}</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>WK_UP</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-5-25 name=__codelineno-5-25 href=#__codelineno-5-25></a><span class=w>            </span><span class=k>return</span><span class=w> </span><span class=n>WKUP_PRES</span><span class=p>;</span>
<a id=__codelineno-5-26 name=__codelineno-5-26 href=#__codelineno-5-26></a><span class=w>        </span><span class=p>}</span>
<a id=__codelineno-5-27 name=__codelineno-5-27 href=#__codelineno-5-27></a><span class=w>    </span><span class=p>}</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>KEY0</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=n>KEY1</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=n>WK_UP</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=mi>0</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-5-28 name=__codelineno-5-28 href=#__codelineno-5-28></a><span class=w>        </span><span class=n>key_up</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=p>;</span>
<a id=__codelineno-5-29 name=__codelineno-5-29 href=#__codelineno-5-29></a><span class=w>    </span><span class=p>}</span>
<a id=__codelineno-5-30 name=__codelineno-5-30 href=#__codelineno-5-30></a><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=cm>/* 无按键按下 */</span>
<a id=__codelineno-5-31 name=__codelineno-5-31 href=#__codelineno-5-31></a><span class=p>}</span>
<a id=__codelineno-5-32 name=__codelineno-5-32 href=#__codelineno-5-32></a>
<a id=__codelineno-5-33 name=__codelineno-5-33 href=#__codelineno-5-33></a><span class=cm>/* 括号内换行 */</span>
<a id=__codelineno-5-34 name=__codelineno-5-34 href=#__codelineno-5-34></a><span class=n>xTaskCreate</span><span class=p>((</span><span class=n>TaskFunction_t</span><span class=p>)</span><span class=n>start_task</span><span class=p>,</span><span class=w> </span><span class=cm>/* 任务函数 */</span>
<a id=__codelineno-5-35 name=__codelineno-5-35 href=#__codelineno-5-35></a><span class=w>            </span><span class=p>(</span><span class=k>const</span><span class=w> </span><span class=kt>char</span><span class=w> </span><span class=o>*</span><span class=p>)</span><span class=s>&quot;start_task&quot;</span><span class=p>,</span><span class=w> </span><span class=cm>/* 任务名称 */</span>
<a id=__codelineno-5-36 name=__codelineno-5-36 href=#__codelineno-5-36></a><span class=w>            </span><span class=p>(</span><span class=kt>uint16_t</span><span class=p>)</span><span class=n>START_STK_SIZE</span><span class=p>,</span><span class=w>   </span><span class=cm>/* 任务堆栈大小 */</span>
<a id=__codelineno-5-37 name=__codelineno-5-37 href=#__codelineno-5-37></a><span class=w>            </span><span class=p>(</span><span class=kt>void</span><span class=w> </span><span class=o>*</span><span class=p>)</span><span class=nb>NULL</span><span class=p>,</span><span class=w>               </span><span class=cm>/* 传入给任务函数的参数 */</span>
<a id=__codelineno-5-38 name=__codelineno-5-38 href=#__codelineno-5-38></a><span class=w>            </span><span class=p>(</span><span class=n>UBaseType_t</span><span class=p>)</span><span class=n>START_TASK_PRIO</span><span class=p>,</span><span class=w>           </span><span class=cm>/* 任务优先级 */</span>
<a id=__codelineno-5-39 name=__codelineno-5-39 href=#__codelineno-5-39></a><span class=w>            </span><span class=p>(</span><span class=n>TaskHandle_t</span><span class=w> </span><span class=o>*</span><span class=p>)</span><span class=o>&amp;</span><span class=n>g_start_task_handler</span><span class=p>);</span><span class=w> </span><span class=cm>/* 任务句柄 */</span>
<a id=__codelineno-5-40 name=__codelineno-5-40 href=#__codelineno-5-40></a>
<a id=__codelineno-5-41 name=__codelineno-5-41 href=#__codelineno-5-41></a><span class=cm>/* 下一行的位置与第一行括号后的第一个字符对齐, 最后的右括号不换行 */</span>
<a id=__codelineno-5-42 name=__codelineno-5-42 href=#__codelineno-5-42></a><span class=n>ring_fifo_t</span><span class=w> </span><span class=o>*</span><span class=nf>ring_fifo_init</span><span class=p>(</span><span class=kt>void</span><span class=w> </span><span class=o>*</span><span class=n>buf</span><span class=p>,</span><span class=w> </span><span class=kt>uint32_t</span><span class=w> </span><span class=n>size</span><span class=p>,</span>
<a id=__codelineno-5-43 name=__codelineno-5-43 href=#__codelineno-5-43></a><span class=w>                            </span><span class=k>enum</span><span class=w> </span><span class=n>ring_fifo_type</span><span class=w> </span><span class=n>type</span><span class=p>);</span>
</code></pre></div> <h3 id=_15>空行</h3> <ul> <li>文件头注释后有一个空行</li> </ul> <ul> <li>函数之间须加一个空行</li> </ul> <ul> <li>在注释某个函数、结构体、枚举、变量的功能时候不要加空行，见下面注释的说明</li> </ul> <ul> <li>在一个函数中，每个相对独立的操作完成以后最好有一个空行，比如下面的代码块，11,17,23行都有一个空行，表示上一个操作完成了，该下一个操作了，方便阅读</li> </ul> <div class=highlight><pre><span></span><code><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a><span class=cm>/**</span>
<a id=__codelineno-6-2 name=__codelineno-6-2 href=#__codelineno-6-2></a><span class=cm> * @brief 用户从快递柜取包裹</span>
<a id=__codelineno-6-3 name=__codelineno-6-3 href=#__codelineno-6-3></a><span class=cm> * </span>
<a id=__codelineno-6-4 name=__codelineno-6-4 href=#__codelineno-6-4></a><span class=cm> * @param pick_up_code 取件码</span>
<a id=__codelineno-6-5 name=__codelineno-6-5 href=#__codelineno-6-5></a><span class=cm> * @return status_t 操作状态</span>
<a id=__codelineno-6-6 name=__codelineno-6-6 href=#__codelineno-6-6></a><span class=cm> */</span>
<a id=__codelineno-6-7 name=__codelineno-6-7 href=#__codelineno-6-7></a><span class=n>status_t</span><span class=w> </span><span class=nf>user_pick_up_express</span><span class=p>(</span><span class=kt>uint32_t</span><span class=w> </span><span class=n>pick_up_code</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-6-8 name=__codelineno-6-8 href=#__codelineno-6-8></a><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>pick_up_code</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=mi>0</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-6-9 name=__codelineno-6-9 href=#__codelineno-6-9></a><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>ERR_INPUT_NULL</span><span class=p>;</span>
<a id=__codelineno-6-10 name=__codelineno-6-10 href=#__codelineno-6-10></a><span class=w>    </span><span class=p>}</span>
<a id=__codelineno-6-11 name=__codelineno-6-11 href=#__codelineno-6-11></a><span class=c1>// 11行，这里空一行</span>
<a id=__codelineno-6-12 name=__codelineno-6-12 href=#__codelineno-6-12></a><span class=w>    </span><span class=kt>uint32_t</span><span class=w> </span><span class=n>cabinet_number</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>seek_express_by_code</span><span class=p>(</span><span class=n>pick_up_code</span><span class=p>);</span>
<a id=__codelineno-6-13 name=__codelineno-6-13 href=#__codelineno-6-13></a><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>cabinet_number</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=mi>0</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-6-14 name=__codelineno-6-14 href=#__codelineno-6-14></a><span class=w>        </span><span class=cm>/* 柜子编号不存在 */</span>
<a id=__codelineno-6-15 name=__codelineno-6-15 href=#__codelineno-6-15></a><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>ERR_NO_FOUND</span><span class=p>;</span>
<a id=__codelineno-6-16 name=__codelineno-6-16 href=#__codelineno-6-16></a><span class=w>    </span><span class=p>}</span>
<a id=__codelineno-6-17 name=__codelineno-6-17 href=#__codelineno-6-17></a><span class=c1>// 17行，这里空一行</span>
<a id=__codelineno-6-18 name=__codelineno-6-18 href=#__codelineno-6-18></a><span class=w>    </span><span class=n>status_t</span><span class=w> </span><span class=n>cabient_status</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>cabient_open_the_door</span><span class=p>(</span><span class=n>cabient_number</span><span class=p>);</span>
<a id=__codelineno-6-19 name=__codelineno-6-19 href=#__codelineno-6-19></a><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>cabient_status</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=n>ERROR</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-6-20 name=__codelineno-6-20 href=#__codelineno-6-20></a><span class=w>        </span><span class=cm>/* 开门出错, 可能是柜子继电器出问题了, 提示联系管理员 */</span>
<a id=__codelineno-6-21 name=__codelineno-6-21 href=#__codelineno-6-21></a><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>ERR_OPEN_DOOR</span><span class=p>;</span>
<a id=__codelineno-6-22 name=__codelineno-6-22 href=#__codelineno-6-22></a><span class=w>    </span><span class=p>}</span>
<a id=__codelineno-6-23 name=__codelineno-6-23 href=#__codelineno-6-23></a><span class=c1>// 23行，这里空一行</span>
<a id=__codelineno-6-24 name=__codelineno-6-24 href=#__codelineno-6-24></a><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=n>OK</span><span class=p>;</span>
<a id=__codelineno-6-25 name=__codelineno-6-25 href=#__codelineno-6-25></a><span class=p>}</span>
</code></pre></div> <p>用一堆<code>*</code>隔开也是个不错的选择，不过要注意一行80个字符</p> <h3 id=_16>代码行</h3> <ul> <li>一行代码只做一件事情，比如只定义一个变量，或者一条语句，这样方便阅读与注释</li> </ul> <ul> <li>多个语句不要放在一行里，一行内不要写多个连续赋值的语句</li> </ul> <ul> <li>一行代码尽量不要多个变量。如果在逻辑上比较相近，可以写在一行上，比如<code>float width, height;</code></li> </ul> <ul> <li>一行最多80个字符，写代码经常需要分屏，一行代码如果太长就不太方便了。</li> </ul> <div class=highlight><pre><span></span><code><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a><span class=cm>/* 不规范写法 */</span>
<a id=__codelineno-7-2 name=__codelineno-7-2 href=#__codelineno-7-2></a><span class=n>a</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>y</span><span class=p>;</span><span class=w> </span><span class=n>b</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>y</span><span class=p>;</span>
<a id=__codelineno-7-3 name=__codelineno-7-3 href=#__codelineno-7-3></a><span class=n>a</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>b</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
<a id=__codelineno-7-4 name=__codelineno-7-4 href=#__codelineno-7-4></a>
<a id=__codelineno-7-5 name=__codelineno-7-5 href=#__codelineno-7-5></a><span class=cm>/* 规范写法 */</span>
<a id=__codelineno-7-6 name=__codelineno-7-6 href=#__codelineno-7-6></a><span class=n>a</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>y</span><span class=p>;</span>
<a id=__codelineno-7-7 name=__codelineno-7-7 href=#__codelineno-7-7></a><span class=n>b</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>y</span><span class=p>;</span>
<a id=__codelineno-7-8 name=__codelineno-7-8 href=#__codelineno-7-8></a><span class=n>a</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
<a id=__codelineno-7-9 name=__codelineno-7-9 href=#__codelineno-7-9></a><span class=n>b</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
</code></pre></div> <h3 id=_17>代码块</h3> <ul> <li><strong><code>if, for, while, do</code>这类语句，必须加花括号，一个语句也必须加</strong>，这样可以有效防止编码时出现的失误</li> </ul> <ul> <li><strong>及时清理未使用的函数、变量等死代码</strong>，不要妨碍阅读，可读性是第一位的。</li> </ul> <blockquote> <p>未使用的代码叫做死代码(Dead-code)，Dead-code在一个企业项目中都是很危险的，这是由于Dead-code一般写完以后就不会再看了，就算code reviewing时reviewer也只是大概扫两眼，不会去执行调用，这段代码就会失去维护。如果哪一天某个人突然调用了Dead-code中的函数，这个函数有很隐蔽的bug，突然有一天就触发了，这会造成不可预估的损失。因此对于Dead-code，宁愿移除，未来某天再重写一遍，也不会放在哪里不管。</p> </blockquote> <ul> <li>要注意逻辑上永远不可能执行的代码，如果没有更改Template的警告等级，编译会给警告：</li> </ul> <p><img alt=image.png src=image.png></p> <ul> <li>对于空语句，保留一个<code>{}</code>即可，括号里面即没有空格，也不换行，但是对于<code>if else</code>，括号内要换行；如果使用分号，必须换行，且分号前缩进。这样做意在提示阅读者注意此处的逻辑。</li> </ul> <div class=highlight><pre><span></span><code><a id=__codelineno-8-1 name=__codelineno-8-1 href=#__codelineno-8-1></a><span class=cm>/* 不规范写法 */</span>
<a id=__codelineno-8-2 name=__codelineno-8-2 href=#__codelineno-8-2></a><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>condition</span><span class=p>)</span>
<a id=__codelineno-8-3 name=__codelineno-8-3 href=#__codelineno-8-3></a><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=nb>true</span><span class=p>;</span>
<a id=__codelineno-8-4 name=__codelineno-8-4 href=#__codelineno-8-4></a>
<a id=__codelineno-8-5 name=__codelineno-8-5 href=#__codelineno-8-5></a><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>condition</span><span class=p>)</span><span class=w> </span><span class=k>return</span><span class=w> </span><span class=nb>true</span><span class=p>;</span>
<a id=__codelineno-8-6 name=__codelineno-8-6 href=#__codelineno-8-6></a>
<a id=__codelineno-8-7 name=__codelineno-8-7 href=#__codelineno-8-7></a><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>condition</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=k>return</span><span class=w> </span><span class=nb>true</span><span class=p>;</span><span class=w> </span><span class=p>}</span>
<a id=__codelineno-8-8 name=__codelineno-8-8 href=#__codelineno-8-8></a>
<a id=__codelineno-8-9 name=__codelineno-8-9 href=#__codelineno-8-9></a><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>condition</span><span class=p>)</span><span class=w> </span><span class=p>{}</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-8-10 name=__codelineno-8-10 href=#__codelineno-8-10></a><span class=w>    </span><span class=p>...</span>
<a id=__codelineno-8-11 name=__codelineno-8-11 href=#__codelineno-8-11></a><span class=p>}</span>
<a id=__codelineno-8-12 name=__codelineno-8-12 href=#__codelineno-8-12></a><span class=k>while</span><span class=w> </span><span class=p>(</span><span class=n>condition</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-8-13 name=__codelineno-8-13 href=#__codelineno-8-13></a><span class=p>}</span>
<a id=__codelineno-8-14 name=__codelineno-8-14 href=#__codelineno-8-14></a>
<a id=__codelineno-8-15 name=__codelineno-8-15 href=#__codelineno-8-15></a><span class=cm>/* 规范写法 */</span>
<a id=__codelineno-8-16 name=__codelineno-8-16 href=#__codelineno-8-16></a><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>condition</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-8-17 name=__codelineno-8-17 href=#__codelineno-8-17></a><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=nb>true</span><span class=p>;</span>
<a id=__codelineno-8-18 name=__codelineno-8-18 href=#__codelineno-8-18></a><span class=p>}</span>
<a id=__codelineno-8-19 name=__codelineno-8-19 href=#__codelineno-8-19></a><span class=cm>/* 空语句规范写法 */</span>
<a id=__codelineno-8-20 name=__codelineno-8-20 href=#__codelineno-8-20></a><span class=k>while</span><span class=w> </span><span class=p>(</span><span class=n>condition</span><span class=p>)</span><span class=w> </span><span class=p>{}</span>
<a id=__codelineno-8-21 name=__codelineno-8-21 href=#__codelineno-8-21></a><span class=cm>/* 如果不用上面的方式, 可以采用下面的方式. 如果分号不换行易被误认成函数调用 */</span>
<a id=__codelineno-8-22 name=__codelineno-8-22 href=#__codelineno-8-22></a><span class=k>while</span><span class=w> </span><span class=p>(</span><span class=n>condition</span><span class=p>)</span>
<a id=__codelineno-8-23 name=__codelineno-8-23 href=#__codelineno-8-23></a><span class=w>    </span><span class=p>;</span>
<a id=__codelineno-8-24 name=__codelineno-8-24 href=#__codelineno-8-24></a><span class=cm>/* if else中的空语句括号需换行. 如果大括号中间不换行易被误认成if条件成立后执行 */</span>
<a id=__codelineno-8-25 name=__codelineno-8-25 href=#__codelineno-8-25></a><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>condition</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-8-26 name=__codelineno-8-26 href=#__codelineno-8-26></a><span class=p>}</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-8-27 name=__codelineno-8-27 href=#__codelineno-8-27></a><span class=w>    </span><span class=p>...</span>
<a id=__codelineno-8-28 name=__codelineno-8-28 href=#__codelineno-8-28></a><span class=p>}</span>
</code></pre></div> <h3 id=_18>函数</h3> <ul> <li><strong>一个函数尽量不要超过10个局部变量</strong>，超过说明你的功能太复杂了，要考虑优化</li> </ul> <ul> <li>函数参数也不要太多，最多6个，太多说明你的功能太复杂了，要考虑优化</li> </ul> <ul> <li>一个函数也不要太长，100行左右为宜，太长同理</li> </ul> <ul> <li>校验逻辑放前面，发现错误早返回，这样能有效减少嵌套，避免代码逻辑错误</li> </ul> <ul> <li><strong>嵌入式代码不允许使用递归</strong>，递归对于资源消耗巨大，易造成栈溢出</li> </ul> <ul> <li>有返回值的函数，<strong>末尾必须要<code>return</code>默认值</strong>，如果没有返回任何值编译会给警告</li> </ul> <ul> <li>对于无参的函数，加<code>void</code>，不要在括号里什么都不写。例如：<code>int main(void)</code> ，而非<code>int main()</code></li> </ul> <ul> <li>函数的功能要单一，不能处理太多的业务逻辑，对于单一模块的文件服务的对象也要单一，不要让一个文件或者函数成大杂烩。</li> </ul> <blockquote> <p>文件和函数的功能要专一。举个例子，医院是一个完整的程序，一家综合性医院一般都会有若干个科室，比如内科、外科、放射科等等。而内科又包括呼吸科、心血管科，但是内科不会有皮肤科。外科包括骨科、脑外科，但是不会有消化内科。同样的，在程序中也不能这样，保证服务的对象统一。像呼吸科这样的专科门诊就可以看作一个独立的文件，医生给你治病的流程相当于函数。</p> <p>但是我们在程序中经常会遇到一些交叉的功能，比如医院的放射科，就会有内外科交叉。骨折了得去放射科拍片子，脑子里有肿瘤，也得去放射科拍片子。那么对于这种代码需要我们处理好内外的逻辑，不要乱七八糟的，也不要一股脑全放到一个地方。当然实际情况当然没有没有那么理想，这就需要你自己思考，仔细斟酌，找到最优解。</p> </blockquote> <h3 id=_19>变量</h3> <ul> <li>所有局部变量哪里用在哪里声明。<strong>使用前必须定义，不准使用未定义的变量</strong></li> </ul> <ul> <li>如果初值可以确定，写在一行上，不要分开写：<code>xxxStatus_t xxx_status = get_xxx_status(xxx);</code></li> </ul> <ul> <li>不确定初值的变量给<code>0</code>或<code>1</code>，不确定初值的指针给<code>NULL</code>，不确定的结构体变量给<code>{0}</code></li> </ul> <ul> <li>不能让变量的作用域超出它的实际作用范围，比如一个变量就在<code>if</code>条件成立里用，你就不应该声明在<code>if</code>外。<strong>尤其是对于循环变量<code>i, j, k</code></strong>，如果只是单纯的下标意义，在<code>for</code>里面声明并定义，不要在外边声明，也就是：<code>for (int i = 0, i &lt; count; i++)</code></li> </ul> <ul> <li>如果一个全局变量只有一个文件使用，尽量加<code>static</code>修饰符，这样能避免其他人在其他文件调用本文件的变量，产生预期之外的后果。<strong>全局变量如果不加<code>static</code>，整个程序是可以访问的，任何一个地方的<code>extern</code>声明都可以访问到这个变量。</strong></li> </ul> <ul> <li>对于只用写入一次初值的变量，可以加<code>const</code>修饰符，这样能够避免其他人乱改变量的值产生预期之外的后果。</li> </ul> <blockquote> <p>一个有趣的冷知识，我们写的程序大部分变量，大多只是给了一次初值后再没变过。但大量的<code>const</code>修饰符势必会造成阅读负担，因此对于一些关键的变量考虑是否加<code>const</code>修饰符是非常有必要的，这样就不用担心变量在某个隐蔽的角落被重新赋值。</p> </blockquote> <div class=highlight><pre><span></span><code><a id=__codelineno-9-1 name=__codelineno-9-1 href=#__codelineno-9-1></a><span class=kt>uint32_t</span><span class=w> </span><span class=n>arr</span><span class=p>[</span><span class=mi>4</span><span class=p>];</span>
<a id=__codelineno-9-2 name=__codelineno-9-2 href=#__codelineno-9-2></a><span class=kt>int16_t</span><span class=w> </span><span class=n>foo</span><span class=p>;</span>
<a id=__codelineno-9-3 name=__codelineno-9-3 href=#__codelineno-9-3></a><span class=cm>/* 不允许未定义就使用arr数组 */</span>
<a id=__codelineno-9-4 name=__codelineno-9-4 href=#__codelineno-9-4></a><span class=n>printf</span><span class=p>(</span><span class=s>&quot;%d&quot;</span><span class=p>,</span><span class=w> </span><span class=n>a</span><span class=p>[</span><span class=mi>1</span><span class=p>]);</span>
<a id=__codelineno-9-5 name=__codelineno-9-5 href=#__codelineno-9-5></a><span class=cm>/* 不允许使用未定义的变量 */</span>
<a id=__codelineno-9-6 name=__codelineno-9-6 href=#__codelineno-9-6></a><span class=kt>int16_t</span><span class=w> </span><span class=n>bar</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>foo</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=p>;</span>
<a id=__codelineno-9-7 name=__codelineno-9-7 href=#__codelineno-9-7></a>
<a id=__codelineno-9-8 name=__codelineno-9-8 href=#__codelineno-9-8></a><span class=cm>/* 对于不确定内容的数组, 使用memset初始化 */</span>
<a id=__codelineno-9-9 name=__codelineno-9-9 href=#__codelineno-9-9></a><span class=n>memset</span><span class=p>(</span><span class=n>arr</span><span class=p>,</span><span class=w> </span><span class=mi>0</span><span class=p>,</span><span class=w> </span><span class=k>sizeof</span><span class=p>(</span><span class=n>arr</span><span class=p>));</span>
<a id=__codelineno-9-10 name=__codelineno-9-10 href=#__codelineno-9-10></a><span class=cm>/* 申请堆内存时, 使用calloc可以将申请的内存设置为零 */</span>
<a id=__codelineno-9-11 name=__codelineno-9-11 href=#__codelineno-9-11></a><span class=kt>uint16_t</span><span class=w> </span><span class=o>*</span><span class=n>new_data</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=kt>uint16_t</span><span class=w> </span><span class=o>*</span><span class=p>)</span><span class=n>calloc</span><span class=p>(</span><span class=k>sizeof</span><span class=p>(</span><span class=kt>uint16_t</span><span class=p>)</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>MAX_LEN</span><span class=p>);</span>
</code></pre></div> <h3 id=_20>复杂数据类型</h3> <ul> <li>对于结构体或者联合体，除非不公开，只用来声明一个或几个变量，否则<strong>统一使用<code>typedef</code>定义名称</strong>，并结尾带<code>_t</code>后缀</li> </ul> <div class=highlight><pre><span></span><code><a id=__codelineno-10-1 name=__codelineno-10-1 href=#__codelineno-10-1></a><span class=cm>/* 正确写法 */</span>
<a id=__codelineno-10-2 name=__codelineno-10-2 href=#__codelineno-10-2></a><span class=k>typedef</span><span class=w> </span><span class=k>struct</span><span class=w> </span><span class=nc>foo</span><span class=w> </span><span class=p>{</span><span class=w>   </span><span class=cm>/* 此处foo可写可不写, 不写就是匿名结构体. 如果有像下面这样需要引用该结构体指针的那必须写 */</span>
<a id=__codelineno-10-3 name=__codelineno-10-3 href=#__codelineno-10-3></a><span class=w>    </span><span class=k>struct</span><span class=w> </span><span class=nc>foo</span><span class=w> </span><span class=o>*</span><span class=n>next</span><span class=p>;</span><span class=w>  </span><span class=cm>/*!&lt; next item */</span>
<a id=__codelineno-10-4 name=__codelineno-10-4 href=#__codelineno-10-4></a><span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=n>index</span><span class=p>;</span><span class=w>         </span><span class=cm>/*!&lt; index of item */</span>
<a id=__codelineno-10-5 name=__codelineno-10-5 href=#__codelineno-10-5></a><span class=w>    </span><span class=kt>uint8_t</span><span class=w> </span><span class=n>flag</span><span class=p>;</span><span class=w>      </span><span class=cm>/*!&lt; flag of item */</span>
<a id=__codelineno-10-6 name=__codelineno-10-6 href=#__codelineno-10-6></a><span class=w>    </span><span class=p>...</span>
<a id=__codelineno-10-7 name=__codelineno-10-7 href=#__codelineno-10-7></a><span class=p>}</span><span class=w> </span><span class=n>foo_t</span><span class=p>;</span><span class=w>               </span><span class=cm>/* 使用_t后缀 */</span>
<a id=__codelineno-10-8 name=__codelineno-10-8 href=#__codelineno-10-8></a><span class=n>foo_t</span><span class=w> </span><span class=n>foo_obj</span><span class=p>;</span><span class=w>         </span><span class=cm>/* 定义结构体变量 */</span>
<a id=__codelineno-10-9 name=__codelineno-10-9 href=#__codelineno-10-9></a>
<a id=__codelineno-10-10 name=__codelineno-10-10 href=#__codelineno-10-10></a><span class=cm>/* 错误写法 */</span>
<a id=__codelineno-10-11 name=__codelineno-10-11 href=#__codelineno-10-11></a><span class=k>struct</span><span class=w> </span><span class=nc>foo</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-10-12 name=__codelineno-10-12 href=#__codelineno-10-12></a><span class=w>    </span><span class=k>struct</span><span class=w> </span><span class=nc>foo</span><span class=w> </span><span class=o>*</span><span class=n>next</span><span class=p>;</span><span class=w>  </span><span class=cm>/*!&lt; next item */</span>
<a id=__codelineno-10-13 name=__codelineno-10-13 href=#__codelineno-10-13></a><span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=n>index</span><span class=p>;</span><span class=w>         </span><span class=cm>/*!&lt; index of item */</span>
<a id=__codelineno-10-14 name=__codelineno-10-14 href=#__codelineno-10-14></a><span class=w>    </span><span class=kt>uint8_t</span><span class=w> </span><span class=n>flag</span><span class=p>;</span><span class=w>      </span><span class=cm>/*!&lt; flag of item */</span>
<a id=__codelineno-10-15 name=__codelineno-10-15 href=#__codelineno-10-15></a><span class=w>    </span><span class=p>...</span>
<a id=__codelineno-10-16 name=__codelineno-10-16 href=#__codelineno-10-16></a><span class=p>};</span>
<a id=__codelineno-10-17 name=__codelineno-10-17 href=#__codelineno-10-17></a><span class=n>sturct</span><span class=w> </span><span class=n>foo</span><span class=w> </span><span class=n>foo_obj</span><span class=p>;</span><span class=w>         </span><span class=cm>/* 定义结构体变量 */</span>
<a id=__codelineno-10-18 name=__codelineno-10-18 href=#__codelineno-10-18></a>
<a id=__codelineno-10-19 name=__codelineno-10-19 href=#__codelineno-10-19></a><span class=cm>/* 特殊情况, 只声明一个或几个结构体变量, 这种不用typedef名词 */</span>
<a id=__codelineno-10-20 name=__codelineno-10-20 href=#__codelineno-10-20></a><span class=cm>/* 如果内部使用考虑是否需要static修饰符, 加在struct前面 */</span>
<a id=__codelineno-10-21 name=__codelineno-10-21 href=#__codelineno-10-21></a><span class=k>struct</span><span class=w> </span><span class=nc>foo</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-10-22 name=__codelineno-10-22 href=#__codelineno-10-22></a><span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=n>index_of_foo</span><span class=p>;</span><span class=w>      </span><span class=cm>/*!&lt; 索引 */</span>
<a id=__codelineno-10-23 name=__codelineno-10-23 href=#__codelineno-10-23></a><span class=w>    </span><span class=n>data_t</span><span class=w> </span><span class=n>data_of_foo</span><span class=p>;</span><span class=w>    </span><span class=cm>/*!&lt; 数据 */</span>
<a id=__codelineno-10-24 name=__codelineno-10-24 href=#__codelineno-10-24></a><span class=w>    </span><span class=p>...</span>
<a id=__codelineno-10-25 name=__codelineno-10-25 href=#__codelineno-10-25></a><span class=p>}</span><span class=w> </span><span class=n>foo_variable_1</span><span class=p>,</span><span class=w> </span><span class=n>foo_variable_2</span><span class=w> </span><span class=p>...</span><span class=w> </span><span class=p>;</span>
</code></pre></div> <ul> <li>对于枚举，枚举成员使用大写（当然某些情况下可以使用小写）</li> </ul> <ul> <li>与宏定义类似，如果只用来列举数据，比如数组下标，那么可以不定义名称</li> </ul> <ul> <li>枚举类型可以用来作为参数或者返回值。枚举成员一行只写一个成员，不要堆在一行上。</li> </ul> <div class=highlight><pre><span></span><code><a id=__codelineno-11-1 name=__codelineno-11-1 href=#__codelineno-11-1></a><span class=cm>/**</span>
<a id=__codelineno-11-2 name=__codelineno-11-2 href=#__codelineno-11-2></a><span class=cm> * @brief GPIO电平定义</span>
<a id=__codelineno-11-3 name=__codelineno-11-3 href=#__codelineno-11-3></a><span class=cm> */</span>
<a id=__codelineno-11-4 name=__codelineno-11-4 href=#__codelineno-11-4></a><span class=k>typedef</span><span class=w> </span><span class=k>enum</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-11-5 name=__codelineno-11-5 href=#__codelineno-11-5></a><span class=w>    </span><span class=n>GPIO_PIN_RESET</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mh>0x00U</span><span class=p>,</span>
<a id=__codelineno-11-6 name=__codelineno-11-6 href=#__codelineno-11-6></a><span class=w>    </span><span class=n>GPIO_PIN_SET</span>
<a id=__codelineno-11-7 name=__codelineno-11-7 href=#__codelineno-11-7></a><span class=p>}</span><span class=w> </span><span class=n>GPIO_PinState_t</span><span class=p>;</span>
<a id=__codelineno-11-8 name=__codelineno-11-8 href=#__codelineno-11-8></a>
<a id=__codelineno-11-9 name=__codelineno-11-9 href=#__codelineno-11-9></a><span class=cm>/**</span>
<a id=__codelineno-11-10 name=__codelineno-11-10 href=#__codelineno-11-10></a><span class=cm> * @brief 状态定义</span>
<a id=__codelineno-11-11 name=__codelineno-11-11 href=#__codelineno-11-11></a><span class=cm> */</span>
<a id=__codelineno-11-12 name=__codelineno-11-12 href=#__codelineno-11-12></a><span class=k>typedef</span><span class=w> </span><span class=k>enum</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-11-13 name=__codelineno-11-13 href=#__codelineno-11-13></a><span class=w>    </span><span class=n>HAL_OK</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mh>0x00U</span><span class=p>,</span>
<a id=__codelineno-11-14 name=__codelineno-11-14 href=#__codelineno-11-14></a><span class=w>    </span><span class=n>HAL_ERROR</span><span class=p>,</span>
<a id=__codelineno-11-15 name=__codelineno-11-15 href=#__codelineno-11-15></a><span class=w>    </span><span class=n>HAL_BUSY</span><span class=p>,</span>
<a id=__codelineno-11-16 name=__codelineno-11-16 href=#__codelineno-11-16></a><span class=w>    </span><span class=n>HAL_TIMEOUT</span>
<a id=__codelineno-11-17 name=__codelineno-11-17 href=#__codelineno-11-17></a><span class=p>}</span><span class=w> </span><span class=n>HAL_Status_t</span><span class=p>;</span>
<a id=__codelineno-11-18 name=__codelineno-11-18 href=#__codelineno-11-18></a>
<a id=__codelineno-11-19 name=__codelineno-11-19 href=#__codelineno-11-19></a><span class=cm>/* 不要写成这样, 成员不换行 */</span>
<a id=__codelineno-11-20 name=__codelineno-11-20 href=#__codelineno-11-20></a><span class=k>typedef</span><span class=w> </span><span class=k>enum</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-11-21 name=__codelineno-11-21 href=#__codelineno-11-21></a><span class=w>    </span><span class=n>HAL_OK</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mh>0x00U</span><span class=p>,</span><span class=w> </span><span class=n>HAL_ERROR</span><span class=p>,</span><span class=w> </span><span class=n>HAL_BUSY</span><span class=p>,</span><span class=w> </span><span class=n>HAL_TIMEOUT</span>
<a id=__codelineno-11-22 name=__codelineno-11-22 href=#__codelineno-11-22></a><span class=p>}</span><span class=w> </span><span class=n>HAL_Status_t</span><span class=p>;</span>
<a id=__codelineno-11-23 name=__codelineno-11-23 href=#__codelineno-11-23></a>
<a id=__codelineno-11-24 name=__codelineno-11-24 href=#__codelineno-11-24></a><span class=cm>/**</span>
<a id=__codelineno-11-25 name=__codelineno-11-25 href=#__codelineno-11-25></a><span class=cm> * @brief HAL写入GPIO电平</span>
<a id=__codelineno-11-26 name=__codelineno-11-26 href=#__codelineno-11-26></a><span class=cm> * </span>
<a id=__codelineno-11-27 name=__codelineno-11-27 href=#__codelineno-11-27></a><span class=cm> * @param GPIOx GPIO端口</span>
<a id=__codelineno-11-28 name=__codelineno-11-28 href=#__codelineno-11-28></a><span class=cm> * @param GPIO_Pin GPIO引脚</span>
<a id=__codelineno-11-29 name=__codelineno-11-29 href=#__codelineno-11-29></a><span class=cm> * @param PinState 写入电平</span>
<a id=__codelineno-11-30 name=__codelineno-11-30 href=#__codelineno-11-30></a><span class=cm> * @return `HAL_Status_t` 是否写入成功</span>
<a id=__codelineno-11-31 name=__codelineno-11-31 href=#__codelineno-11-31></a><span class=cm> * @note 实际HAL库逻辑并非这样, 只是举个例子</span>
<a id=__codelineno-11-32 name=__codelineno-11-32 href=#__codelineno-11-32></a><span class=cm> */</span>
<a id=__codelineno-11-33 name=__codelineno-11-33 href=#__codelineno-11-33></a><span class=n>HAL_Status_t</span><span class=w> </span><span class=nf>HAL_GPIO_Write_Pin</span><span class=p>(</span><span class=n>GPIO_t</span><span class=w> </span><span class=o>*</span><span class=n>GPIOx</span><span class=p>,</span><span class=w> </span><span class=kt>uint16_t</span><span class=w> </span><span class=n>GPIO_Pin</span><span class=p>,</span>
<a id=__codelineno-11-34 name=__codelineno-11-34 href=#__codelineno-11-34></a><span class=w>                                </span><span class=n>GPIO_PinState_t</span><span class=w> </span><span class=n>PinState</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-11-35 name=__codelineno-11-35 href=#__codelineno-11-35></a><span class=w>    </span><span class=n>assert_param</span><span class=p>(</span><span class=n>IS_GPIO_PIN</span><span class=p>(</span><span class=n>GPIO_Pin</span><span class=p>));</span>
<a id=__codelineno-11-36 name=__codelineno-11-36 href=#__codelineno-11-36></a><span class=w>    </span><span class=p>...</span>
<a id=__codelineno-11-37 name=__codelineno-11-37 href=#__codelineno-11-37></a><span class=w>    </span><span class=n>GPIOx</span><span class=o>-&gt;</span><span class=n>ODR</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>GPIO</span><span class=o>-&gt;</span><span class=n>IDR</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=p>(</span><span class=n>GPIO_PinState</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>GPIO_Pin</span><span class=p>);</span>
<a id=__codelineno-11-38 name=__codelineno-11-38 href=#__codelineno-11-38></a><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>GPIOx</span><span class=o>-&gt;</span><span class=n>IDR</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=n>GPIOx</span><span class=o>-&gt;</span><span class=n>ODR</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-11-39 name=__codelineno-11-39 href=#__codelineno-11-39></a><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>HAL_OK</span><span class=p>;</span>
<a id=__codelineno-11-40 name=__codelineno-11-40 href=#__codelineno-11-40></a><span class=w>    </span><span class=p>}</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-11-41 name=__codelineno-11-41 href=#__codelineno-11-41></a><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>HAL_ERROR</span>
<a id=__codelineno-11-42 name=__codelineno-11-42 href=#__codelineno-11-42></a><span class=w>    </span><span class=p>}</span>
<a id=__codelineno-11-43 name=__codelineno-11-43 href=#__codelineno-11-43></a><span class=p>}</span>
<a id=__codelineno-11-44 name=__codelineno-11-44 href=#__codelineno-11-44></a>
<a id=__codelineno-11-45 name=__codelineno-11-45 href=#__codelineno-11-45></a><span class=cm>/* 纯下标定义, 可以不用typedef定义名称 */</span>
<a id=__codelineno-11-46 name=__codelineno-11-46 href=#__codelineno-11-46></a><span class=k>enum</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-11-47 name=__codelineno-11-47 href=#__codelineno-11-47></a><span class=w>    </span><span class=n>LAST</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mh>0x00U</span><span class=p>,</span>
<a id=__codelineno-11-48 name=__codelineno-11-48 href=#__codelineno-11-48></a><span class=w>    </span><span class=n>NOW</span><span class=p>,</span>
<a id=__codelineno-11-49 name=__codelineno-11-49 href=#__codelineno-11-49></a><span class=w>    </span><span class=n>NEXT</span>
<a id=__codelineno-11-50 name=__codelineno-11-50 href=#__codelineno-11-50></a><span class=p>};</span>
<a id=__codelineno-11-51 name=__codelineno-11-51 href=#__codelineno-11-51></a><span class=n>array</span><span class=p>[</span><span class=n>LAST</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>...;</span>
</code></pre></div> <h3 id=_21>数组与指针</h3> <ul> <li>对于指针，<strong><code>*</code>放在变量名的一侧</strong>，即<code>char *pointer = NULL</code>，而非类型的一侧，即<code>char* pointer = NULL</code>。放在右边是要注意下面的情况：</li> </ul> <div class=highlight><pre><span></span><code><a id=__codelineno-12-1 name=__codelineno-12-1 href=#__codelineno-12-1></a><span class=kt>int</span><span class=o>*</span><span class=w> </span><span class=n>p</span><span class=p>,</span><span class=w> </span><span class=n>q</span><span class=p>;</span><span class=w> </span><span class=cm>/* 当这样声明的时候p是int指针, q是int变量, 相当于: int* p; int q; */</span>
<a id=__codelineno-12-2 name=__codelineno-12-2 href=#__codelineno-12-2></a><span class=cm>/* 所以采用下面的方式, 看起来统一 */</span>
<a id=__codelineno-12-3 name=__codelineno-12-3 href=#__codelineno-12-3></a><span class=kt>int</span><span class=w> </span><span class=o>*</span><span class=n>p</span><span class=p>,</span><span class=w> </span><span class=o>*</span><span class=n>q</span><span class=p>;</span>
</code></pre></div> <ul> <li>不建议一行代码声明多个变量，因此尽量避免像上面这样即声明指针又声明变量。</li> </ul> <ul> <li>申请的内存必须及时释放，否则会造成内存泄漏。</li> </ul> <ul> <li><strong>指针嵌套（比如指向指针<code>int*</code>的指针<code>int**</code>）最多三层，数组最多三维数组</strong></li> </ul> <ul> <li>对于结构体、联合体这种复杂数据类型，函数之间传递时尽量使用指针，以减少内存开销，以及避免可能产生的内存泄漏。</li> </ul> <h3 id=_22>宏定义</h3> <ul> <li>续行符右对齐</li> </ul> <ul> <li>宏定义如果有<code>#if</code>嵌套，不缩进</li> </ul> <ul> <li>使用<code>#define</code>定义常量时，常量值对齐</li> </ul> <div class=highlight><pre><span></span><code><a id=__codelineno-13-1 name=__codelineno-13-1 href=#__codelineno-13-1></a><span class=cm>/* 不规范写法 */</span>
<a id=__codelineno-13-2 name=__codelineno-13-2 href=#__codelineno-13-2></a><span class=cp>#define USE_FOO 0</span>
<a id=__codelineno-13-3 name=__codelineno-13-3 href=#__codelineno-13-3></a><span class=cp>#define NOT_USE_BAR 1</span>
<a id=__codelineno-13-4 name=__codelineno-13-4 href=#__codelineno-13-4></a>
<a id=__codelineno-13-5 name=__codelineno-13-5 href=#__codelineno-13-5></a><span class=cp>#if NOT_USE_BAR</span>
<a id=__codelineno-13-6 name=__codelineno-13-6 href=#__codelineno-13-6></a>
<a id=__codelineno-13-7 name=__codelineno-13-7 href=#__codelineno-13-7></a><span class=w>    </span><span class=cp>#define IS_FOO</span>
<a id=__codelineno-13-8 name=__codelineno-13-8 href=#__codelineno-13-8></a><span class=kt>void</span><span class=w> </span><span class=nf>foo</span><span class=p>(</span><span class=kt>void</span><span class=p>);</span>
<a id=__codelineno-13-9 name=__codelineno-13-9 href=#__codelineno-13-9></a>
<a id=__codelineno-13-10 name=__codelineno-13-10 href=#__codelineno-13-10></a><span class=cp>#else  </span><span class=cm>/* NOT_USE_BAR */</span>
<a id=__codelineno-13-11 name=__codelineno-13-11 href=#__codelineno-13-11></a>
<a id=__codelineno-13-12 name=__codelineno-13-12 href=#__codelineno-13-12></a><span class=w>    </span><span class=cp>#define IS_BAR</span>
<a id=__codelineno-13-13 name=__codelineno-13-13 href=#__codelineno-13-13></a><span class=kt>void</span><span class=w> </span><span class=nf>bar</span><span class=p>(</span><span class=kt>void</span><span class=p>);</span>
<a id=__codelineno-13-14 name=__codelineno-13-14 href=#__codelineno-13-14></a>
<a id=__codelineno-13-15 name=__codelineno-13-15 href=#__codelineno-13-15></a><span class=cp>#define LED0(x) \</span>
<a id=__codelineno-13-16 name=__codelineno-13-16 href=#__codelineno-13-16></a><span class=cp>    (x) ? HAL_GPIO_WritePin(LED0_PORT, LED0_PIN, GPIO_PIN_SET) \</span>
<a id=__codelineno-13-17 name=__codelineno-13-17 href=#__codelineno-13-17></a><span class=cp>        : HAL_GPIO_WritePin(LED0_PORT, LED0_PIN, GPIO_PIN_RESET)</span>
<a id=__codelineno-13-18 name=__codelineno-13-18 href=#__codelineno-13-18></a>
<a id=__codelineno-13-19 name=__codelineno-13-19 href=#__codelineno-13-19></a><span class=cp>#endif </span><span class=cm>/* NOT_USE_BAR */</span>
<a id=__codelineno-13-20 name=__codelineno-13-20 href=#__codelineno-13-20></a>
<a id=__codelineno-13-21 name=__codelineno-13-21 href=#__codelineno-13-21></a><span class=cm>/* 规范写法 */</span>
<a id=__codelineno-13-22 name=__codelineno-13-22 href=#__codelineno-13-22></a><span class=cp>#define USE_FOO     0</span>
<a id=__codelineno-13-23 name=__codelineno-13-23 href=#__codelineno-13-23></a><span class=cp>#define NOT_USE_BAR 1</span>
<a id=__codelineno-13-24 name=__codelineno-13-24 href=#__codelineno-13-24></a>
<a id=__codelineno-13-25 name=__codelineno-13-25 href=#__codelineno-13-25></a><span class=cp>#if NOT_USE_BAR</span>
<a id=__codelineno-13-26 name=__codelineno-13-26 href=#__codelineno-13-26></a>
<a id=__codelineno-13-27 name=__codelineno-13-27 href=#__codelineno-13-27></a><span class=cp>#define IS_FOO</span>
<a id=__codelineno-13-28 name=__codelineno-13-28 href=#__codelineno-13-28></a><span class=kt>void</span><span class=w> </span><span class=nf>foo</span><span class=p>(</span><span class=kt>void</span><span class=p>);</span>
<a id=__codelineno-13-29 name=__codelineno-13-29 href=#__codelineno-13-29></a>
<a id=__codelineno-13-30 name=__codelineno-13-30 href=#__codelineno-13-30></a><span class=cp>#else  </span><span class=cm>/* NOT_USE_BAR */</span>
<a id=__codelineno-13-31 name=__codelineno-13-31 href=#__codelineno-13-31></a>
<a id=__codelineno-13-32 name=__codelineno-13-32 href=#__codelineno-13-32></a><span class=cp>#define IS_BAR</span>
<a id=__codelineno-13-33 name=__codelineno-13-33 href=#__codelineno-13-33></a><span class=kt>void</span><span class=w> </span><span class=nf>bar</span><span class=p>(</span><span class=kt>void</span><span class=p>);</span>
<a id=__codelineno-13-34 name=__codelineno-13-34 href=#__codelineno-13-34></a><span class=cm>/* 最右边的反斜杠就是续行符, 右对齐 */</span>
<a id=__codelineno-13-35 name=__codelineno-13-35 href=#__codelineno-13-35></a><span class=cp>#define LED0(x)                                                                \</span>
<a id=__codelineno-13-36 name=__codelineno-13-36 href=#__codelineno-13-36></a><span class=cp>    (x) ? HAL_GPIO_WritePin(LED0_PORT, LED0_PIN, GPIO_PIN_SET)                 \</span>
<a id=__codelineno-13-37 name=__codelineno-13-37 href=#__codelineno-13-37></a><span class=cp>        : HAL_GPIO_WritePin(LED0_PORT, LED0_PIN, GPIO_PIN_RESET)</span>
<a id=__codelineno-13-38 name=__codelineno-13-38 href=#__codelineno-13-38></a>
<a id=__codelineno-13-39 name=__codelineno-13-39 href=#__codelineno-13-39></a><span class=cp>#endif </span><span class=cm>/* NOT_USE_BAR */</span>
</code></pre></div> <p>VSCode和Keil可以折叠宏定义，这样未启用的宏定义可以不显示</p> <h3 id=goto>goto</h3> <ul> <li>可以使用<code>goto</code>，<code>goto</code>作为函数退出时使用非常方便，Linux内核中也有不少代码用了<code>goto</code>。但务必逻辑简单易懂，不要滥用</li> </ul> <ul> <li>使用<code>goto</code>不要形成循环；尽量往后跳转，不要跳转到前面。往前跳转容易形成潜在的逻辑错误。</li> </ul> <p><img alt=image.png src=image%201.png></p> <h3 id=_23>杂项</h3> <ul> <li>不要使用魔法数字(Magic Number)，即突如其来的数字，意义不明，比如<code>int magic_number = 3;</code>你告诉我这个3是干什么的</li> </ul> <ul> <li>如果要使用常数尽量用宏定义，但是不要出现这种宏定义：<code>#define FIVE 5</code>，谁不知道FIVE是5啊，代码里不能直接写5吗</li> </ul> <ul> <li>不要对浮点数做相等或者不等判断，浮点数由于精度问题并不会按照我们预期的方式执行。很典型的例子，可以自己写个程序看一下<code>0.1 + 0.2 == 0.3</code>的值，你会发现这个条件的结果是0即<code>false</code></li> </ul> <ul> <li>注意强制类型转换，仔细思考这样做是否有问题</li> </ul> <h2 id=_24>注释</h2> <p><strong>代码必须写注释，不写注释的都是<a href=https://www.bilibili.com/video/av838862989/ >↓↑</a></strong></p> <p>注释使用<a href=https://www.doxygen.nl/index.html>doxygen</a>标准。行注释<code>//</code>用在注释代码上。doxygen支持<a href=https://www.markdownguide.org/ >Markdown</a>语法</p> <p>doxygen的标签可以以<code>@</code>或者<code>\</code>开头，<strong>这里统一规定使用<code>@</code>作为标签开头</strong>。</p> <p>doxygen规定的标签可点击<a href=https://www.doxygen.nl/manual/commands.html>此处</a>查阅，如果标签是doxygen规定的，vscode会自动识别标签并显示相应的颜色。下面列举几个常用的，用法参照官方文档，或者下面的内容</p> <div class=highlight><pre><span></span><code><a id=__codelineno-14-1 name=__codelineno-14-1 href=#__codelineno-14-1></a><span class=cm>/**</span>
<a id=__codelineno-14-2 name=__codelineno-14-2 href=#__codelineno-14-2></a><span class=cm> * @arg         @attention  @author     @brief      @bug</span>
<a id=__codelineno-14-3 name=__codelineno-14-3 href=#__codelineno-14-3></a><span class=cm> * @copyright   @date       @def        @defgroup   @details</span>
<a id=__codelineno-14-4 name=__codelineno-14-4 href=#__codelineno-14-4></a><span class=cm> * @note        @param      @private    @public     @ref</span>
<a id=__codelineno-14-5 name=__codelineno-14-5 href=#__codelineno-14-5></a><span class=cm> * @return      @retval     @see        @todo       @version</span>
<a id=__codelineno-14-6 name=__codelineno-14-6 href=#__codelineno-14-6></a><span class=cm> * @warning</span>
<a id=__codelineno-14-7 name=__codelineno-14-7 href=#__codelineno-14-7></a><span class=cm> */</span>
</code></pre></div> <p>在VSCode中切换行注释的快捷键是<code>Ctrl + /</code>，按下后就会自动添加空格。切换块注释的快捷键是<code>Alt + Shift + A</code>，按下后前后也会自动加空格。我一般把这个快捷键改成<code>Alt + /</code>，在左下角齿轮，KeyBoard Shortcuts(键盘快捷键)，然后搜索<code>blockComment</code>，找到Toogle Block Comment(切换块注释)，点第二列的快捷键，按下你想要的快捷键，保存即可。如果快捷键冲突，可以先查找这个快捷键，解除后再录入新的快捷键。</p> <h3 id=_25>文件头</h3> <p>文件注释标准, 写明文件名<code>@file</code>, 作者<code>@author</code>, 简介<code>@brief</code>, 版本<code>@version</code>, 日期<code>@date</code>, 版权信息等。建议使用空格对齐（按一个Tab为4空格），看起来较为整齐。</p> <p>注意版本号的更新，对于开发初期的版本，主版本号使用0，更新副版本号；如果是较为稳定的发布版本，更新主版本号。</p> <div class=highlight><pre><span></span><code><a id=__codelineno-15-1 name=__codelineno-15-1 href=#__codelineno-15-1></a><span class=cm>/**</span>
<a id=__codelineno-15-2 name=__codelineno-15-2 href=#__codelineno-15-2></a><span class=cm> * @file    commune.c</span>
<a id=__codelineno-15-3 name=__codelineno-15-3 href=#__codelineno-15-3></a><span class=cm> * @author  Deadline039</span>
<a id=__codelineno-15-4 name=__codelineno-15-4 href=#__codelineno-15-4></a><span class=cm> * @brief   通信代码</span>
<a id=__codelineno-15-5 name=__codelineno-15-5 href=#__codelineno-15-5></a><span class=cm> * @version 0.1</span>
<a id=__codelineno-15-6 name=__codelineno-15-6 href=#__codelineno-15-6></a><span class=cm> * @date    2023-11-05</span>
<a id=__codelineno-15-7 name=__codelineno-15-7 href=#__codelineno-15-7></a><span class=cm> * @note    遥控器发送的数据帧都为8个字节, 开头统一为0xFF, 结尾统一为0xCC</span>
<a id=__codelineno-15-8 name=__codelineno-15-8 href=#__codelineno-15-8></a><span class=cm> *          --------------------------------------------------------------------</span>
<a id=__codelineno-15-9 name=__codelineno-15-9 href=#__codelineno-15-9></a><span class=cm> *          遥控器数据帧格式:</span>
<a id=__codelineno-15-10 name=__codelineno-15-10 href=#__codelineno-15-10></a><span class=cm> *          0xFF, 0xAA(标识遥控器), x1, y1, x2, y2, keys, 0xCC</span>
<a id=__codelineno-15-11 name=__codelineno-15-11 href=#__codelineno-15-11></a><span class=cm> *          --------------------------------------------------------------------</span>
<a id=__codelineno-15-12 name=__codelineno-15-12 href=#__codelineno-15-12></a><span class=cm> *          握手数据帧格式:</span>
<a id=__codelineno-15-13 name=__codelineno-15-13 href=#__codelineno-15-13></a><span class=cm> *          0xFF, &#39;h&#39;(标识握手), &#39;e&#39;, &#39;l&#39;, &#39;l&#39;, &#39;o&#39;, 0x00, 0xCC</span>
<a id=__codelineno-15-14 name=__codelineno-15-14 href=#__codelineno-15-14></a><span class=cm> *          主板回复格式</span>
<a id=__codelineno-15-15 name=__codelineno-15-15 href=#__codelineno-15-15></a><span class=cm> *          &#39;O&#39;, &#39;K&#39;, 0x00, 0xCC</span>
<a id=__codelineno-15-16 name=__codelineno-15-16 href=#__codelineno-15-16></a><span class=cm> *          --------------------------------------------------------------------</span>
<a id=__codelineno-15-17 name=__codelineno-15-17 href=#__codelineno-15-17></a><span class=cm> *          发送key数据帧格式</span>
<a id=__codelineno-15-18 name=__codelineno-15-18 href=#__codelineno-15-18></a><span class=cm> *          0xFF, 0xFE(标识key), key, key, key, key, 0x00, 0xCC</span>
<a id=__codelineno-15-19 name=__codelineno-15-19 href=#__codelineno-15-19></a><span class=cm> *          --------------------------------------------------------------------</span>
<a id=__codelineno-15-20 name=__codelineno-15-20 href=#__codelineno-15-20></a><span class=cm> *          检查连接数据帧格式</span>
<a id=__codelineno-15-21 name=__codelineno-15-21 href=#__codelineno-15-21></a><span class=cm> *          0xFF, 0xFF(标识检验), 0x00, 0x00, 0x00, 0x00, 0x00, 0xCC</span>
<a id=__codelineno-15-22 name=__codelineno-15-22 href=#__codelineno-15-22></a><span class=cm> *          主板回复格式</span>
<a id=__codelineno-15-23 name=__codelineno-15-23 href=#__codelineno-15-23></a><span class=cm> *          key, key, key, key, 0x00, 0xCC</span>
<a id=__codelineno-15-24 name=__codelineno-15-24 href=#__codelineno-15-24></a><span class=cm> *******************************************************************************</span>
<a id=__codelineno-15-25 name=__codelineno-15-25 href=#__codelineno-15-25></a><span class=cm> *          CHECK_CONNECT宏用来定义是否进行连接检查, 0为不使用; 1为使用</span>
<a id=__codelineno-15-26 name=__codelineno-15-26 href=#__codelineno-15-26></a><span class=cm> *          如果不使用连接检查, 开机直接向主板发送遥控器数据</span>
<a id=__codelineno-15-27 name=__codelineno-15-27 href=#__codelineno-15-27></a><span class=cm> *</span>
<a id=__codelineno-15-28 name=__codelineno-15-28 href=#__codelineno-15-28></a><span class=cm> *          如果使用连接检查, 上电会持续发送握手数据帧, 等待主板回复OK</span>
<a id=__codelineno-15-29 name=__codelineno-15-29 href=#__codelineno-15-29></a><span class=cm> *          主板回复后, 向主板发送一个32位的key, 这个key是随机生成的</span>
<a id=__codelineno-15-30 name=__codelineno-15-30 href=#__codelineno-15-30></a><span class=cm> *          发送格式就是key数据帧格式</span>
<a id=__codelineno-15-31 name=__codelineno-15-31 href=#__codelineno-15-31></a><span class=cm> *</span>
<a id=__codelineno-15-32 name=__codelineno-15-32 href=#__codelineno-15-32></a><span class=cm> *          遥控器每发送20帧遥控器数据, 会发送一个检查连接数据帧,</span>
<a id=__codelineno-15-33 name=__codelineno-15-33 href=#__codelineno-15-33></a><span class=cm> *          主板将key发送给遥控器, 遥控器进行校验. 如果错误, 提示连接出错</span>
<a id=__codelineno-15-34 name=__codelineno-15-34 href=#__codelineno-15-34></a><span class=cm> */</span>
</code></pre></div> <h3 id=_26>函数</h3> <p>注明简介<code>@brief</code>, 参数<code>@param</code>, 有时还使用<code>@arg</code>来指定传入的参数值, 返回值<code>@retval, @return</code>等。参数作为输入<code>[in]</code>可以省略，作为输出需加<code>[out]</code>，C不支持引用参数，一般为指针</p> <p>每条列表项目可以不用空格对齐，<code>arg</code>与<code>param</code>前错开一个空格，但是如果一个列表内的内容要换行，对齐上一行的开头</p> <div class=highlight><pre><span></span><code><a id=__codelineno-16-1 name=__codelineno-16-1 href=#__codelineno-16-1></a><span class=cm>/**</span>
<a id=__codelineno-16-2 name=__codelineno-16-2 href=#__codelineno-16-2></a><span class=cm> * @brief Starts the TIM Input Capture measurement. 这里可以不与下面的retval对齐</span>
<a id=__codelineno-16-3 name=__codelineno-16-3 href=#__codelineno-16-3></a><span class=cm> * @param htim TIM Input Capture handle</span>
<a id=__codelineno-16-4 name=__codelineno-16-4 href=#__codelineno-16-4></a><span class=cm> * @param Channel TIM Channels to be enabled. This parameter can be one of the</span>
<a id=__codelineno-16-5 name=__codelineno-16-5 href=#__codelineno-16-5></a><span class=cm> *                following values: (这里换行了, 与上一行开头对齐)</span>
<a id=__codelineno-16-6 name=__codelineno-16-6 href=#__codelineno-16-6></a><span class=cm> *  @arg TIM_CHANNEL_1: TIM Channel 1 selected  开头与@param错开一个空格</span>
<a id=__codelineno-16-7 name=__codelineno-16-7 href=#__codelineno-16-7></a><span class=cm> *  @arg TIM_CHANNEL_2: TIM Channel 2 selected</span>
<a id=__codelineno-16-8 name=__codelineno-16-8 href=#__codelineno-16-8></a><span class=cm> *  @arg TIM_CHANNEL_3: TIM Channel 3 selected</span>
<a id=__codelineno-16-9 name=__codelineno-16-9 href=#__codelineno-16-9></a><span class=cm> *  @arg TIM_CHANNEL_4: TIM Channel 4 selected</span>
<a id=__codelineno-16-10 name=__codelineno-16-10 href=#__codelineno-16-10></a><span class=cm> * @retval HAL status</span>
<a id=__codelineno-16-11 name=__codelineno-16-11 href=#__codelineno-16-11></a><span class=cm> * @note 注意12行和13行之间不应该有空格</span>
<a id=__codelineno-16-12 name=__codelineno-16-12 href=#__codelineno-16-12></a><span class=cm> */</span>
<a id=__codelineno-16-13 name=__codelineno-16-13 href=#__codelineno-16-13></a><span class=n>HAL_StatusTypeDef</span><span class=w> </span><span class=nf>HAL_TIM_IC_Start</span><span class=p>(</span><span class=n>TIM_HandleTypeDef</span><span class=w> </span><span class=o>*</span><span class=n>htim</span><span class=p>,</span><span class=w> </span><span class=kt>uint32_t</span><span class=w> </span><span class=n>Channel</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-16-14 name=__codelineno-16-14 href=#__codelineno-16-14></a><span class=w>    </span><span class=kt>uint32_t</span><span class=w> </span><span class=n>tmpsmcr</span><span class=p>;</span>
<a id=__codelineno-16-15 name=__codelineno-16-15 href=#__codelineno-16-15></a><span class=w>    </span><span class=cm>/* 双斜杠仅在注释代码时使用 */</span>
<a id=__codelineno-16-16 name=__codelineno-16-16 href=#__codelineno-16-16></a><span class=w>    </span><span class=c1>// HAL_TIM_ChannelStateTypeDef channel_state = TIM_CHANNEL_STATE_GET(htim, Channel);</span>
<a id=__codelineno-16-17 name=__codelineno-16-17 href=#__codelineno-16-17></a><span class=w>    </span><span class=c1>// HAL_TIM_ChannelStateTypeDef complementary_channel_state = TIM_CHANNEL_N_STATE_GET(htim, Channel);</span>
<a id=__codelineno-16-18 name=__codelineno-16-18 href=#__codelineno-16-18></a>
<a id=__codelineno-16-19 name=__codelineno-16-19 href=#__codelineno-16-19></a><span class=w>    </span><span class=cm>/* Check the parameters */</span>
<a id=__codelineno-16-20 name=__codelineno-16-20 href=#__codelineno-16-20></a><span class=w>    </span><span class=n>assert_param</span><span class=p>(</span><span class=n>IS_TIM_CCX_INSTANCE</span><span class=p>(</span><span class=n>htim</span><span class=o>-&gt;</span><span class=n>Instance</span><span class=p>,</span><span class=w> </span><span class=n>Channel</span><span class=p>));</span>
<a id=__codelineno-16-21 name=__codelineno-16-21 href=#__codelineno-16-21></a><span class=w>    </span><span class=p>...</span>
<a id=__codelineno-16-22 name=__codelineno-16-22 href=#__codelineno-16-22></a><span class=w>    </span><span class=cm>/* Return function status */</span>
<a id=__codelineno-16-23 name=__codelineno-16-23 href=#__codelineno-16-23></a><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=n>HAL_OK</span><span class=p>;</span>
<a id=__codelineno-16-24 name=__codelineno-16-24 href=#__codelineno-16-24></a><span class=p>}</span>
<a id=__codelineno-16-25 name=__codelineno-16-25 href=#__codelineno-16-25></a>
<a id=__codelineno-16-26 name=__codelineno-16-26 href=#__codelineno-16-26></a><span class=cm>/**</span>
<a id=__codelineno-16-27 name=__codelineno-16-27 href=#__codelineno-16-27></a><span class=cm> * @brief 根据传感器数据获取实际位置</span>
<a id=__codelineno-16-28 name=__codelineno-16-28 href=#__codelineno-16-28></a><span class=cm> *</span>
<a id=__codelineno-16-29 name=__codelineno-16-29 href=#__codelineno-16-29></a><span class=cm> * @param[out] real_x x位置指针</span>
<a id=__codelineno-16-30 name=__codelineno-16-30 href=#__codelineno-16-30></a><span class=cm> * @param[out] real_y y位置指针</span>
<a id=__codelineno-16-31 name=__codelineno-16-31 href=#__codelineno-16-31></a><span class=cm> */</span>
<a id=__codelineno-16-32 name=__codelineno-16-32 href=#__codelineno-16-32></a><span class=kt>void</span><span class=w> </span><span class=nf>GetPosition</span><span class=p>(</span><span class=kt>double</span><span class=o>*</span><span class=w> </span><span class=n>real_x</span><span class=p>,</span><span class=w> </span><span class=kt>double</span><span class=o>*</span><span class=w> </span><span class=n>real_y</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-16-33 name=__codelineno-16-33 href=#__codelineno-16-33></a><span class=w>    </span><span class=o>*</span><span class=n>real_x</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>...;</span>
<a id=__codelineno-16-34 name=__codelineno-16-34 href=#__codelineno-16-34></a><span class=w>    </span><span class=o>*</span><span class=n>real_y</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>...;</span>
<a id=__codelineno-16-35 name=__codelineno-16-35 href=#__codelineno-16-35></a><span class=p>}</span>
</code></pre></div> <p>如果函数使用的是标准的doxygen注释的，在vscode里鼠标放到一个函数上悬停会显示相关信息，输入参数时也会提示现在输入的是什么参数。空格不影响这里展示的内容，vscode会自动忽略空格。注意文件编码为UTF-8。</p> <p><img alt=image-20231022205719017.png src=image-20231022205719017.png></p> <p><img alt=image-20231022205832560.png src=image-20231022205832560.png></p> <h3 id=_27>结构体</h3> <p>结构体前注明简介，每个成员都说明作用，说明成员作用时使用<code>/*!&lt; xx */</code></p> <div class=highlight><pre><span></span><code><a id=__codelineno-17-1 name=__codelineno-17-1 href=#__codelineno-17-1></a><span class=cm>/**</span>
<a id=__codelineno-17-2 name=__codelineno-17-2 href=#__codelineno-17-2></a><span class=cm> * @brief  TIM Clear Input Configuration Handle Structure definition</span>
<a id=__codelineno-17-3 name=__codelineno-17-3 href=#__codelineno-17-3></a><span class=cm> */</span>
<a id=__codelineno-17-4 name=__codelineno-17-4 href=#__codelineno-17-4></a><span class=k>typedef</span><span class=w> </span><span class=k>struct</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-17-5 name=__codelineno-17-5 href=#__codelineno-17-5></a><span class=w>  </span><span class=kt>uint32_t</span><span class=w> </span><span class=n>ClearInputState</span><span class=p>;</span><span class=w>      </span><span class=cm>/*!&lt; TIM clear Input state</span>
<a id=__codelineno-17-6 name=__codelineno-17-6 href=#__codelineno-17-6></a><span class=cm>                                      This parameter can be ENABLE or DISABLE */</span>
<a id=__codelineno-17-7 name=__codelineno-17-7 href=#__codelineno-17-7></a><span class=w>  </span><span class=kt>uint32_t</span><span class=w> </span><span class=n>ClearInputSource</span><span class=p>;</span><span class=w>     </span><span class=cm>/*!&lt; TIM clear Input sources</span>
<a id=__codelineno-17-8 name=__codelineno-17-8 href=#__codelineno-17-8></a><span class=cm>                                      This parameter can be a value of @ref TIM_ClearInput_Source */</span>
<a id=__codelineno-17-9 name=__codelineno-17-9 href=#__codelineno-17-9></a><span class=w>  </span><span class=kt>uint32_t</span><span class=w> </span><span class=n>ClearInputPolarity</span><span class=p>;</span><span class=w>   </span><span class=cm>/*!&lt; TIM Clear Input polarity</span>
<a id=__codelineno-17-10 name=__codelineno-17-10 href=#__codelineno-17-10></a><span class=cm>                                      This parameter can be a value of @ref TIM_ClearInput_Polarity */</span>
<a id=__codelineno-17-11 name=__codelineno-17-11 href=#__codelineno-17-11></a><span class=w>  </span><span class=kt>uint32_t</span><span class=w> </span><span class=n>ClearInputPrescaler</span><span class=p>;</span><span class=w>  </span><span class=cm>/*!&lt; TIM Clear Input prescaler</span>
<a id=__codelineno-17-12 name=__codelineno-17-12 href=#__codelineno-17-12></a><span class=cm>                                      This parameter must be 0: When OCRef clear feature is used with ETR source, </span>
<a id=__codelineno-17-13 name=__codelineno-17-13 href=#__codelineno-17-13></a><span class=cm>                                      ETR prescaler must be off */</span>
<a id=__codelineno-17-14 name=__codelineno-17-14 href=#__codelineno-17-14></a><span class=w>  </span><span class=kt>uint32_t</span><span class=w> </span><span class=n>ClearInputFilter</span><span class=p>;</span><span class=w>     </span><span class=cm>/*!&lt; TIM Clear Input filter</span>
<a id=__codelineno-17-15 name=__codelineno-17-15 href=#__codelineno-17-15></a><span class=cm>                                      This parameter can be a number between Min_Data = 0x0 and Max_Data = 0xF */</span>
<a id=__codelineno-17-16 name=__codelineno-17-16 href=#__codelineno-17-16></a><span class=p>}</span><span class=w> </span><span class=n>TIM_ClearInputConfigTypeDef</span><span class=p>;</span>
</code></pre></div> <h3 id=_28>模块</h3> <p>当一段代码是一个模块时可以用<code>defgroup</code>：</p> <div class=highlight><pre><span></span><code><a id=__codelineno-18-1 name=__codelineno-18-1 href=#__codelineno-18-1></a><span class=cm>/**</span>
<a id=__codelineno-18-2 name=__codelineno-18-2 href=#__codelineno-18-2></a><span class=cm> * @defgroup Moudle 1</span>
<a id=__codelineno-18-3 name=__codelineno-18-3 href=#__codelineno-18-3></a><span class=cm> * @{</span>
<a id=__codelineno-18-4 name=__codelineno-18-4 href=#__codelineno-18-4></a><span class=cm> */</span>
<a id=__codelineno-18-5 name=__codelineno-18-5 href=#__codelineno-18-5></a>
<a id=__codelineno-18-6 name=__codelineno-18-6 href=#__codelineno-18-6></a><span class=p>...</span><span class=w>    </span>
<a id=__codelineno-18-7 name=__codelineno-18-7 href=#__codelineno-18-7></a>
<a id=__codelineno-18-8 name=__codelineno-18-8 href=#__codelineno-18-8></a><span class=cm>/**</span>
<a id=__codelineno-18-9 name=__codelineno-18-9 href=#__codelineno-18-9></a><span class=cm> * @}</span>
<a id=__codelineno-18-10 name=__codelineno-18-10 href=#__codelineno-18-10></a><span class=cm> */</span>
<a id=__codelineno-18-11 name=__codelineno-18-11 href=#__codelineno-18-11></a>
<a id=__codelineno-18-12 name=__codelineno-18-12 href=#__codelineno-18-12></a><span class=cm>/* 也可以加一堆*来区分, 一行80个字符 */</span>
<a id=__codelineno-18-13 name=__codelineno-18-13 href=#__codelineno-18-13></a><span class=cm>/*******************************************************************************</span>
<a id=__codelineno-18-14 name=__codelineno-18-14 href=#__codelineno-18-14></a><span class=cm> * @defgroup Moudle 2</span>
<a id=__codelineno-18-15 name=__codelineno-18-15 href=#__codelineno-18-15></a><span class=cm> * @{</span>
<a id=__codelineno-18-16 name=__codelineno-18-16 href=#__codelineno-18-16></a><span class=cm> */</span>
<a id=__codelineno-18-17 name=__codelineno-18-17 href=#__codelineno-18-17></a>
<a id=__codelineno-18-18 name=__codelineno-18-18 href=#__codelineno-18-18></a><span class=p>...</span>
<a id=__codelineno-18-19 name=__codelineno-18-19 href=#__codelineno-18-19></a>
<a id=__codelineno-18-20 name=__codelineno-18-20 href=#__codelineno-18-20></a><span class=cm>/**</span>
<a id=__codelineno-18-21 name=__codelineno-18-21 href=#__codelineno-18-21></a><span class=cm> * @}</span>
<a id=__codelineno-18-22 name=__codelineno-18-22 href=#__codelineno-18-22></a><span class=cm> ******************************************************************************/</span>
</code></pre></div> <h3 id=_29>预编译命令</h3> <ul> <li>预编译命令的<code>#else, #endif</code>必须在行末注释<code>#if</code>的条件，要不然一堆<code>#endif</code>更根本不知道是哪里的</li> </ul> <ul> <li>根据实际情况适当裁剪，及时清理未使用的函数和变量</li> </ul> <ul> <li>宏定义如果有<code>#if</code>嵌套，不缩进</li> </ul> <p><img alt=image.png src=image%202.png></p> <h3 id=_30>杂项</h3> <ul> <li>不要过度注释，比如<code>key = key_scan(0); /* 扫描按键 */</code>，这个函数一眼就知道是扫描按键的，没必要注释。正点原子的注释是为初学者考虑的，所以每行代码基本都会注释一下。</li> </ul> <ul> <li>代码里不要写无意义的注释。不要把注释写成英语句子的翻译，我们应该翻译的是代码中的逻辑，而不是翻译单词，这种注释没有意义</li> </ul> <ul> <li>对于函数或者文件来说，注释的主要目标是讲清楚这部分代码有什么功能，如何使用，最好将代码逻辑的解释放到具体的代码中，可以简单说一下运行流程。函数、文件的功能注释叫<code>brief</code>，而不是<code>details</code></li> </ul> <ul> <li>注释关键部分和难以理解的点必须注释，比如操作寄存器的代码，如果不查阅手册基本看不懂</li> </ul> <ul> <li>注意注释要和代码相符，不要复制粘贴的时候不改注释</li> </ul> <ul> <li>注释应该在代码的上一行或者行末，不应该在下一行，也不要有空行</li> </ul> <ul> <li>尚未实现完整功能，或者需要更进一步优化的代码，应使用<code>todo</code>；如果代码有bug，使用<code>bug</code>，其他tag用法参照doxygen官方文档</li> </ul> <div class=highlight><pre><span></span><code><a id=__codelineno-19-1 name=__codelineno-19-1 href=#__codelineno-19-1></a><span class=cm>/* 注释应该在这里 */</span>
<a id=__codelineno-19-2 name=__codelineno-19-2 href=#__codelineno-19-2></a><span class=n>event_val</span><span class=w> </span><span class=o>|=</span><span class=w> </span><span class=n>event_bit</span><span class=p>;</span><span class=w>  </span><span class=cm>/* 或者注释在这里 */</span>
<a id=__codelineno-19-3 name=__codelineno-19-3 href=#__codelineno-19-3></a><span class=cm>/* 不应该在这里注释 */</span>
<a id=__codelineno-19-4 name=__codelineno-19-4 href=#__codelineno-19-4></a>
<a id=__codelineno-19-5 name=__codelineno-19-5 href=#__codelineno-19-5></a><span class=cm>/* 这是说明第7行代码的注释, 第6行不应该空 */</span>
<a id=__codelineno-19-6 name=__codelineno-19-6 href=#__codelineno-19-6></a>
<a id=__codelineno-19-7 name=__codelineno-19-7 href=#__codelineno-19-7></a><span class=n>event_val</span><span class=w> </span><span class=o>&lt;&lt;=</span><span class=w> </span><span class=mi>1</span><span class=p>;</span>
<a id=__codelineno-19-8 name=__codelineno-19-8 href=#__codelineno-19-8></a>
<a id=__codelineno-19-9 name=__codelineno-19-9 href=#__codelineno-19-9></a><span class=cm>/**</span>
<a id=__codelineno-19-10 name=__codelineno-19-10 href=#__codelineno-19-10></a><span class=cm> * @todo 此处判断逻辑应该优化</span>
<a id=__codelineno-19-11 name=__codelineno-19-11 href=#__codelineno-19-11></a><span class=cm> */</span>
<a id=__codelineno-19-12 name=__codelineno-19-12 href=#__codelineno-19-12></a><span class=k>if</span><span class=w> </span><span class=p>((</span><span class=n>event_val</span><span class=w> </span><span class=o>&amp;</span><span class=w> </span><span class=mh>0x01</span><span class=p>)</span><span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=o>!</span><span class=p>(</span><span class=n>event_val</span><span class=w> </span><span class=o>&amp;</span><span class=w> </span><span class=mh>0x02</span><span class=p>)</span>
<a id=__codelineno-19-13 name=__codelineno-19-13 href=#__codelineno-19-13></a><span class=w>    </span><span class=o>||</span><span class=w> </span><span class=o>!</span><span class=p>(</span><span class=n>event_val</span><span class=w> </span><span class=o>&amp;</span><span class=w> </span><span class=mh>0x04</span><span class=p>)</span><span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=p>(</span><span class=n>event_val</span><span class=w> </span><span class=o>&amp;</span><span class=w> </span><span class=mh>0x08</span><span class=p>))</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-19-14 name=__codelineno-19-14 href=#__codelineno-19-14></a><span class=w>    </span><span class=p>...</span>
<a id=__codelineno-19-15 name=__codelineno-19-15 href=#__codelineno-19-15></a><span class=p>}</span>
<a id=__codelineno-19-16 name=__codelineno-19-16 href=#__codelineno-19-16></a>
<a id=__codelineno-19-17 name=__codelineno-19-17 href=#__codelineno-19-17></a><span class=cm>/**</span>
<a id=__codelineno-19-18 name=__codelineno-19-18 href=#__codelineno-19-18></a><span class=cm> * @bug 这里的断言有时候会失效</span>
<a id=__codelineno-19-19 name=__codelineno-19-19 href=#__codelineno-19-19></a><span class=cm> */</span>
<a id=__codelineno-19-20 name=__codelineno-19-20 href=#__codelineno-19-20></a><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=o>!</span><span class=n>event_val_assert</span><span class=p>(</span><span class=n>event_val</span><span class=p>))</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-19-21 name=__codelineno-19-21 href=#__codelineno-19-21></a><span class=w>    </span><span class=p>...</span>
<a id=__codelineno-19-22 name=__codelineno-19-22 href=#__codelineno-19-22></a><span class=p>}</span>
</code></pre></div> <h3 id=_31>自动生成注释</h3> <p>如果正确安装了EIDE且没有出错，那么扩展会推荐安装Doxygen Documentation Generator扩展，如果没有，搜索扩展名称到商店自行安装。</p> <p><img alt=image.png src=image%203.png></p> <p>我们不需要手动输入上面的一堆东西，扩展会自动帮我们生成，下面就来演示一下：</p> <p>文件头注释：当我们在一个<strong>新文件的第一行</strong>输入<code>/**</code>回车，就会自动帮我们生成文件头模板：</p> <p><img alt=PixPin_2024-02-10_12-50-04.gif src=PixPin_2024-02-10_12-50-04.gif></p> <p>函数注释：输入<code>/**</code>回车，扩展会自动识别参数和返回值，我们只用输入内容就可以：</p> <p><img alt=PixPin_2024-02-10_13-14-57.gif src=PixPin_2024-02-10_13-14-57.gif></p> <p>当然我们也可以自定义上面<code>file, author</code>的内容，具体位置如下：</p> <p><img alt=image.png src=image%204.png></p> <h2 id=_32>文件编码</h2> <p>为避免同步仓库代码时产生乱码，导致一些不必要的问题，<strong>文件编码统一使用UTF-8</strong>。正点原子的代码全部用的是GB2312。</p> <p><strong>如果使用GB2312编码，vscode悬浮的提示会中文乱码。就比如刚才的函数提示</strong>。</p> <p>下面的Gif演示了如何修改编码。</p> <p><img alt=image.png src=FileEncoding.gif></p> <p>如果打开文件中文乱码，点ReOpen With Encoding尝试编码即可，<strong>千万不要点成Save with Encoding，否则可能无法复原原本的内容</strong>。</p> <p>推荐大家安装GBK to UTF8 for vscode扩展，可以识别到大部分GBK编码的文件，而且可以批量转换编码。</p> <p><img alt=image.png src=image%205.png></p> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg> 回到页面顶部 </button> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=页脚> <a href=../../2024Summer/ class="md-footer__link md-footer__link--prev" aria-label="上一页: 2024暑期学习"> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </div> <div class=md-footer__title> <span class=md-footer__direction> 上一页 </span> <div class=md-ellipsis> 2024暑期学习 </div> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> </div> <div class=md-social> <a href=https://github.com/XJU-Hurricane-Team target=_blank rel=noopener title=Github class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </a> <a href=https://space.bilibili.com/522132031/ target=_blank rel=noopener title=Bilibili class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M488.6 104.1c16.7 18.1 24.4 39.7 23.3 65.7v202.4c-.4 26.4-9.2 48.1-26.5 65.1-17.2 17-39.1 25.9-65.5 26.7H92.02c-26.45-.8-48.21-9.8-65.28-27.2C9.682 419.4.767 396.5 0 368.2V169.8c.767-26 9.682-47.6 26.74-65.7C43.81 87.75 65.57 78.77 92.02 78h29.38L96.05 52.19c-5.75-5.73-8.63-13-8.63-21.79 0-8.8 2.88-16.06 8.63-21.797C101.8 2.868 109.1 0 117.9 0s16.1 2.868 21.9 8.603L213.1 78h88l74.5-69.397C381.7 2.868 389.2 0 398 0c8.8 0 16.1 2.868 21.9 8.603 5.7 5.737 8.6 12.997 8.6 21.797 0 8.79-2.9 16.06-8.6 21.79L394.6 78h29.3c26.4.77 48 9.75 64.7 26.1zm-38.8 69.7c-.4-9.6-3.7-17.4-10.7-23.5-5.2-6.1-14-9.4-22.7-9.8H96.05c-9.59.4-17.45 3.7-23.58 9.8-6.14 6.1-9.4 13.9-9.78 23.5v194.4c0 9.2 3.26 17 9.78 23.5s14.38 9.8 23.58 9.8H416.4c9.2 0 17-3.3 23.3-9.8 6.3-6.5 9.7-14.3 10.1-23.5V173.8zm-264.3 42.7c6.3 6.3 9.7 14.1 10.1 23.2V273c-.4 9.2-3.7 16.9-9.8 23.2-6.2 6.3-14 9.5-23.6 9.5-9.6 0-17.5-3.2-23.6-9.5-6.1-6.3-9.4-14-9.8-23.2v-33.3c.4-9.1 3.8-16.9 10.1-23.2 6.3-6.3 13.2-9.6 23.3-10 9.2.4 17 3.7 23.3 10zm191.5 0c6.3 6.3 9.7 14.1 10.1 23.2V273c-.4 9.2-3.7 16.9-9.8 23.2-6.1 6.3-14 9.5-23.6 9.5-9.6 0-17.4-3.2-23.6-9.5-7-6.3-9.4-14-9.7-23.2v-33.3c.3-9.1 3.7-16.9 10-23.2 6.3-6.3 14.1-9.6 23.3-10 9.2.4 17 3.7 23.3 10z"/></svg> </a> <a href="https://mp.weixin.qq.com/mp/qrcode?scene=10000004&size=102&__biz=MzkzNDYwNDAzMQ==&mid=2247483740&idx=1&sn=7d8b41e41cfe7f3100435bfbffd562e0&send_time=" target=_blank rel=noopener title=微信公众号 class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 576 512"><!-- Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M385.2 167.6c6.4 0 12.6.3 18.8 1.1C387.4 90.3 303.3 32 207.7 32 100.5 32 13 104.8 13 197.4c0 53.4 29.3 97.5 77.9 131.6l-19.3 58.6 68-34.1c24.4 4.8 43.8 9.7 68.2 9.7 6.2 0 12.1-.3 18.3-.8-4-12.9-6.2-26.6-6.2-40.8-.1-84.9 72.9-154 165.3-154zm-104.5-52.9c14.5 0 24.2 9.7 24.2 24.4 0 14.5-9.7 24.2-24.2 24.2-14.8 0-29.3-9.7-29.3-24.2.1-14.7 14.6-24.4 29.3-24.4zm-136.4 48.6c-14.5 0-29.3-9.7-29.3-24.2 0-14.8 14.8-24.4 29.3-24.4 14.8 0 24.4 9.7 24.4 24.4 0 14.6-9.6 24.2-24.4 24.2zM563 319.4c0-77.9-77.9-141.3-165.4-141.3-92.7 0-165.4 63.4-165.4 141.3S305 460.7 397.6 460.7c19.3 0 38.9-5.1 58.6-9.9l53.4 29.3-14.8-48.6C534 402.1 563 363.2 563 319.4zm-219.1-24.5c-9.7 0-19.3-9.7-19.3-19.6 0-9.7 9.7-19.3 19.3-19.3 14.8 0 24.4 9.7 24.4 19.3 0 10-9.7 19.6-24.4 19.6zm107.1 0c-9.7 0-19.3-9.7-19.3-19.6 0-9.7 9.7-19.3 19.3-19.3 14.5 0 24.4 9.7 24.4 19.3.1 10-9.9 19.6-24.4 19.6z"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../..", "features": ["content.code.copy", "content.action.edit", "navigation.tracking", "navigation.tabs", "navigation.footer", "navigation.sections", "navigation.indexes", "toc.follow", "navigation.top", "search.suggest", "search.highlight"], "search": "../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}}</script> <script src=../../assets/javascripts/bundle.fe8b6f2b.min.js></script> <script src=https://cdn.jsdelivr.net/npm/pangu@4.0.7/dist/browser/pangu.min.js></script> <script src=../../javascripts/mathjax.2fe0c1.min.js></script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script src=../../javascripts/tex-mml-chtml.5a5f41.min.js></script> <script src=../../javascripts/embed.11f2a4.min.js></script> </body> </html>